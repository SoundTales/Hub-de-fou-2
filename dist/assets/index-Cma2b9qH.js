const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Accueil-OChyIcLX.js","./vendor-WYr585uA.js","./createLucideIcon-eAH5ksrC.js","./supabase-B76hXWPk.js","./Hub-DtXMZM_c.js","./TaleLanding-DnIA_AlZ.js","./Liseuse-CNNBAyul.js","./CreerTale-iDDSwdDA.js"])))=>i.map(i=>d[i]);
import{r as Y,b as Z,a as G,L as C,c as o,u as D,d as K,N as w,O as Q,R as X,e as g,f as ee,H as te}from"./vendor-WYr585uA.js";import{c as se}from"./supabase-B76hXWPk.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))p(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&p(r)}).observe(document,{childList:!0,subtree:!0});function d(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(t){if(t.ep)return;t.ep=!0;const i=d(t);fetch(t.href,i)}})();var O={exports:{}},S={};var P;function ne(){if(P)return S;P=1;var s=Y(),n=Symbol.for("react.element"),d=Symbol.for("react.fragment"),p=Object.prototype.hasOwnProperty,t=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function r(l,u,x){var a,m={},h=null,c=null;x!==void 0&&(h=""+x),u.key!==void 0&&(h=""+u.key),u.ref!==void 0&&(c=u.ref);for(a in u)p.call(u,a)&&!i.hasOwnProperty(a)&&(m[a]=u[a]);if(l&&l.defaultProps)for(a in u=l.defaultProps,u)m[a]===void 0&&(m[a]=u[a]);return{$$typeof:n,type:l,key:h,ref:c,props:m,_owner:t.current}}return S.Fragment=d,S.jsx=r,S.jsxs=r,S}var F;function re(){return F||(F=1,O.exports=ne()),O.exports}var e=re(),E={},$;function oe(){if($)return E;$=1;var s=Z();return E.createRoot=s.createRoot,E.hydrateRoot=s.hydrateRoot,E}var ae=oe();const ie=G(ae),le="modulepreload",ce=function(s,n){return new URL(s,n).href},z={},N=function(n,d,p){let t=Promise.resolve();if(d&&d.length>0){let x=function(a){return Promise.all(a.map(m=>Promise.resolve(m).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};const r=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");t=x(d.map(a=>{if(a=ce(a,p),a in z)return;z[a]=!0;const m=a.endsWith(".css"),h=m?'[rel="stylesheet"]':"";if(p)for(let j=r.length-1;j>=0;j--){const v=r[j];if(v.href===a&&(!m||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${h}`))return;const c=document.createElement("link");if(c.rel=m?"stylesheet":le,m||(c.as="script"),c.crossOrigin="",c.href=a,u&&c.setAttribute("nonce",u),document.head.appendChild(c),m)return new Promise((j,v)=>{c.addEventListener("load",j),c.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${a}`)))})}))}function i(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return t.then(r=>{for(const l of r||[])l.status==="rejected"&&i(l.reason);return n().catch(i)})};function ue(){const s=new Date().getFullYear();return e.jsxs("footer",{className:"app-footer",children:[e.jsxs("div",{className:"app-footer__content",children:[e.jsxs("div",{className:"app-footer__brand",children:[e.jsx("img",{src:"./logo.svg",alt:"Sound Tales",className:"app-footer__logo"}),e.jsxs("p",{className:"app-footer__tagline",children:["Lisez, écoutez, vivez l'histoire.",e.jsx("br",{}),"Le studio de lecture immersive."]})]}),e.jsxs("nav",{className:"app-footer__nav","aria-label":"Navigation pied de page",children:[e.jsxs("div",{className:"app-footer__col",children:[e.jsx("h4",{children:"Explorer"}),e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx(C,{to:"/",children:"Accueil"})}),e.jsx("li",{children:e.jsx(C,{to:"/hub",children:"Le Hub (Catalogue)"})})]})]}),e.jsxs("div",{className:"app-footer__col",children:[e.jsx("h4",{children:"Créateurs"}),e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx(C,{to:"/creer-tale",children:"Proposer un Tale"})}),e.jsx("li",{children:e.jsx(C,{to:"/creer-tale",children:"Rejoindre le studio"})})]})]}),e.jsxs("div",{className:"app-footer__col",children:[e.jsx("h4",{children:"Légal"}),e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("a",{href:"#",children:"Mentions légales"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"Confidentialité"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"CGU"})})]})]})]})]}),e.jsx("div",{className:"app-footer__bottom",children:e.jsxs("p",{children:["© ",s," Sound Tales. Tous droits réservés."]})})]})}const de="https://gmunwpptyhwiiffcbhcq.supabase.co",he="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdtdW53cHB0eWh3aWlmZmNiaGNxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ5MjUwNjcsImV4cCI6MjA4MDUwMTA2N30.TVUKItSroFvSIBn9FCULzVj2KmvQrm5M7BkBPLsqGKk",L=se(de,he),B=o.createContext({user:null,session:null,loading:!0,signInWithEmail:async()=>{},signOut:async()=>{}});function me({children:s}){const[n,d]=o.useState(null),[p,t]=o.useState(!0);o.useEffect(()=>{let r=!0;L.auth.getSession().then(({data:u})=>{r&&(d(u.session),t(!1))});const{data:l}=L.auth.onAuthStateChange((u,x)=>{d(x)});return()=>{r=!1,l?.subscription?.unsubscribe()}},[]);const i=o.useMemo(()=>({session:n,user:n?.user??null,loading:p,signInWithEmail:async r=>L.auth.signInWithOtp({email:r}),signInWithOAuth:async r=>L.auth.signInWithOAuth({provider:r,options:{redirectTo:window.location.origin}}),signOut:async()=>L.auth.signOut()}),[n,p]);return e.jsx(B.Provider,{value:i,children:s})}function q(){return o.useContext(B)}const pe=({isOpen:s,onClose:n})=>{const[d,p]=o.useState(""),[t,i]=o.useState(!1),[r,l]=o.useState(null),{signInWithEmail:u,signInWithOAuth:x}=q();if(!s)return null;const a=async h=>{h.preventDefault(),i(!0),l(null);try{const{error:c}=await u(d);c?l({type:"error",text:"Erreur lors de l'envoi du lien : "+c.message}):(l({type:"success",text:"Lien de connexion envoyé ! Vérifiez vos emails."}),setTimeout(()=>{n(),l(null),p("")},3e3))}catch{l({type:"error",text:"Une erreur est survenue."})}finally{i(!1)}},m=async h=>{try{const{error:c}=await x(h);if(c)throw c}catch(c){l({type:"error",text:`Erreur de connexion ${h}: `+c.message})}};return e.jsx("div",{className:"modal-overlay",onClick:n,children:e.jsxs("div",{className:"modal-content",onClick:h=>h.stopPropagation(),children:[e.jsx("button",{className:"modal-close",onClick:n,children:"×"}),e.jsx("h2",{children:"Connexion / Inscription"}),e.jsx("p",{children:"Entrez votre email pour vous connecter ou créer un compte."}),e.jsxs("form",{onSubmit:a,children:[e.jsx("input",{type:"email",placeholder:"votre@email.com",value:d,onChange:h=>p(h.target.value),required:!0,className:"modal-input"}),r&&e.jsx("div",{className:`modal-message ${r.type}`,children:r.text}),e.jsx("button",{type:"submit",className:"modal-submit-btn",disabled:t,children:t?"Envoi...":"Se connecter / S'inscrire"})]}),e.jsx("div",{className:"auth-divider",children:e.jsx("span",{children:"Ou continuer avec"})}),e.jsxs("div",{className:"social-buttons",children:[e.jsxs("button",{type:"button",className:"social-btn google",onClick:()=>m("google"),children:[e.jsx("svg",{className:"social-icon",viewBox:"0 0 24 24",width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[e.jsx("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),e.jsx("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),e.jsx("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),e.jsx("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"Google"]}),e.jsxs("button",{type:"button",className:"social-btn facebook",onClick:()=>m("facebook"),children:[e.jsx("svg",{className:"social-icon",viewBox:"0 0 24 24",width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fill:"#1877F2",d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]})]})]})})},k=({isActive:s})=>s?"nav-link nav-link--active":"nav-link";function fe(){const[s,n]=o.useState(!1),[d,p]=o.useState(!0),[t,i]=o.useState(!1),[r,l]=o.useState(!1),[u,x]=o.useState(""),[a,m]=o.useState(!1),h="./logo.svg",c=D();K();const{user:j,loading:v,signInWithEmail:Le,signOut:W}=q();o.useEffect(()=>{let b=window.scrollY,f=0;const A=15,I=()=>{if(t){n(!1);return}const _=window.scrollY,R=_-b,U=_<=15,V=_<=150;if(p(V),U){n(!1),f=0,b=_;return}(R>0&&f<0||R<0&&f>0)&&(f=0),f+=R,f>A&&!s?(n(!0),f=0):f<-A&&s&&(n(!1),f=0),b=_};return window.addEventListener("scroll",I,{passive:!0}),I(),()=>window.removeEventListener("scroll",I)},[t,s]);const H=()=>{i(b=>{const f=!b;return f&&n(!1),f})},y=()=>i(!1),J=async()=>{if(!v){if(j){await W(),x("Déconnecté.");return}m(!0)}},T=c.pathname.startsWith("/hub");c.pathname.startsWith("/tale/");const M=()=>e.jsxs(e.Fragment,{children:[e.jsx(w,{to:"/",end:!0,className:k,onClick:y,children:"Accueil"}),e.jsx(w,{to:"/hub",className:k,onClick:y,children:"Hub"}),e.jsx(w,{to:"/creer-tale",className:k,onClick:y,children:"Créer un Tale"})]});return e.jsxs("div",{className:`app-shell ${T?"app-shell--with-bottom-bar":""}`,children:[e.jsxs("header",{className:`app-header ${s?"app-header--hidden":""} ${d?"":"app-header--solid"} ${d||s?"app-header--transparent":""}`,children:[e.jsxs("button",{type:"button",className:`app-menu-btn ${t?"app-menu-btn--active":""}`,"aria-label":"Afficher les pages","aria-expanded":t,onClick:H,children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx(w,{to:"/",className:"app-logo","aria-label":"Retour à l'accueil",onClick:y,children:e.jsx("img",{src:h,alt:"",loading:"lazy"})}),e.jsx("nav",{className:"app-nav app-nav--desktop",children:e.jsx(M,{})}),e.jsx("button",{type:"button",className:"app-login-btn",onClick:()=>{y(),J()},children:j?"Déconnexion":"Connexion"})]}),u&&e.jsxs("div",{style:{position:"fixed",top:"70px",right:"20px",background:"rgba(0,0,0,0.7)",color:"#fff",padding:"8px 12px",borderRadius:"8px",zIndex:2e3},children:[j&&e.jsx("strong",{children:j.email})," ",u]}),e.jsx("div",{className:`mobile-menu-overlay ${t?"mobile-menu-overlay--open":""}`,children:e.jsx("nav",{className:"mobile-menu-nav",children:e.jsx(M,{})})}),e.jsx("main",{className:`app-main ${T?"app-main--with-bottom":""}`,children:e.jsx(Q,{})}),e.jsx(ue,{}),e.jsx(pe,{isOpen:a,onClose:()=>m(!1)})]})}function xe(){const{pathname:s}=D();return o.useLayoutEffect(()=>{document.documentElement.style.scrollBehavior="auto",window.scrollTo(0,0),setTimeout(()=>{document.documentElement.style.scrollBehavior=""},0)},[s]),null}function je({onComplete:s}){const[n,d]=o.useState(!1);return o.useEffect(()=>{document.body.style.overflow="hidden";const p=setTimeout(()=>{d(!0)},2e3),t=setTimeout(()=>{document.body.style.overflow="",s()},2500);return()=>{clearTimeout(p),clearTimeout(t),document.body.style.overflow=""}},[s]),s?e.jsx("div",{className:`splash-screen ${n?"splash-screen--hidden":""}`,children:e.jsxs("div",{className:"splash-content",children:[e.jsx("img",{src:"/logo.svg",alt:"Sound Tales",className:"splash-logo"}),e.jsx("div",{className:"splash-loader",children:e.jsx("div",{className:"splash-bar"})})]})}):null}const ve=o.lazy(()=>N(()=>import("./Accueil-OChyIcLX.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),ge=o.lazy(()=>N(()=>import("./Hub-DtXMZM_c.js"),__vite__mapDeps([4,1,2,3]),import.meta.url)),ye=o.lazy(()=>N(()=>import("./TaleLanding-DnIA_AlZ.js"),__vite__mapDeps([5,1,3]),import.meta.url)),be=o.lazy(()=>N(()=>import("./Liseuse-CNNBAyul.js"),__vite__mapDeps([6,1,2,3]),import.meta.url)),_e=o.lazy(()=>N(()=>import("./CreerTale-iDDSwdDA.js"),__vite__mapDeps([7,1,3]),import.meta.url));function Se(){const[s,n]=o.useState(()=>!sessionStorage.getItem("hasSeenSplash")),d=()=>{n(!1),sessionStorage.setItem("hasSeenSplash","true")};return e.jsxs(e.Fragment,{children:[s&&e.jsx(je,{onComplete:d}),e.jsx(xe,{}),e.jsx(o.Suspense,{fallback:e.jsx("div",{style:{height:"100vh",backgroundColor:"#1f2023"}}),children:e.jsxs(X,{children:[e.jsxs(g,{element:e.jsx(fe,{}),children:[e.jsx(g,{path:"/",element:e.jsx(ve,{})}),e.jsx(g,{path:"/hub",element:e.jsx(ge,{})}),e.jsx(g,{path:"/creer-tale",element:e.jsx(_e,{})}),e.jsx(g,{path:"/tale/:taleId",element:e.jsx(ye,{})})]}),e.jsx(g,{path:"/lecture/:taleId/:chapterId",element:e.jsx(be,{})})]})})]})}ie.createRoot(document.getElementById("root")).render(e.jsx(ee.StrictMode,{children:e.jsx(me,{children:e.jsx(te,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(Se,{})})})}));export{N as _,e as j,L as s,q as u};

@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Libre+Baskerville:wght@700&family=EB+Garamond:wght@400;600;700&display=swap');

/* Base */
:root { font-family: 'Playfair Display','EB Garamond', serif; color: #1f2023; background-color: #424242; 
  --cta-bg: #ffff80; /* main yellow */
  --cta-sep-bg: #fefde8; /* pale wedge near bookmark */
  --ink: #000000;
  --cta-tip: 22px; /* triangular tip width for CTA */
  /* How far the hero image bleeds under the gallery for a smoother transition */
  --hero-bleed: 220px;
  /* Shared shadows */
  --shadow-btn-hover: 0 3px 8px rgba(0,0,0,0.22), 0 14px 28px rgba(0,0,0,0.32), 0 0 0 1px rgba(0,0,0,0.06);
  --shadow-btn-active: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.05);
}
/* Interaction resets (centralized) */
:where(button,[role="button"],.qbtn,.hero__cta,.hero__bookmark){-webkit-appearance:none;appearance:none}
:where(.qbtn,.hero__cta,.hero__bookmark),:where(.qbtn,.hero__cta,.hero__bookmark) *{-webkit-tap-highlight-color:transparent}
button:focus:not(:focus-visible),
.qbtn:focus:not(:focus-visible),
.hero__cta:focus:not(:focus-visible),
.hero__bookmark:focus:not(:focus-visible){outline:none}
button::-moz-focus-inner,.qbtn::-moz-focus-inner,.hero__cta::-moz-focus-inner,.hero__bookmark::-moz-focus-inner{border:0}
@media(hover:none) and (pointer:coarse){
  html,body{-webkit-tap-highlight-color:transparent}
  .qbtn,.hero__cta,.hero__bookmark,
  .qbtn *,.hero__cta *,.hero__bookmark *{outline:none!important;-webkit-tap-highlight-color:transparent}
  .qbtn,.hero__cta,.hero__bookmark{-webkit-user-select:none;user-select:none;-webkit-touch-callout:none;touch-action:manipulation}
}
/* Pseudo fullscreen: use computed inner height when Fullscreen API is blocked */
html.pseudo-fullscreen, body.pseudo-fullscreen { 
  height: var(--inner-h, 100dvh);
  min-height: var(--inner-h, 100dvh);
}
.pseudo-fullscreen .page { 
  min-height: var(--inner-h, 100dvh);
}
* { box-sizing: border-box; }
body { margin: 0; min-height: 100vh; background: #424242; color: #f5f5f5; }

/* Interaction resets (centralized) */
:where(button,[role="button"],.qbtn,.hero__cta,.hero__bookmark){-webkit-appearance:none;appearance:none}
:where(.qbtn,.hero__cta,.hero__bookmark),:where(.qbtn,.hero__cta,.hero__bookmark) *{-webkit-tap-highlight-color:transparent}
.qbtn:focus:not(:focus-visible),
.hero__cta:focus:not(:focus-visible),
.hero__bookmark:focus:not(:focus-visible),
button:focus:not(:focus-visible){outline:none}
button::-moz-focus-inner,.qbtn::-moz-focus-inner,.hero__cta::-moz-focus-inner,.hero__bookmark::-moz-focus-inner{border:0}
@media(hover:none) and (pointer:coarse){
  html,body{-webkit-tap-highlight-color:transparent}
  .qbtn,.hero__cta,.hero__bookmark,
  .qbtn *,.hero__cta *,.hero__bookmark *{outline:none!important;-webkit-tap-highlight-color:transparent}
  .qbtn,.hero__cta,.hero__bookmark{-webkit-user-select:none;user-select:none;-webkit-touch-callout:none;touch-action:manipulation}
}

/* Hide scrollbars everywhere while preserving scroll */
html, body { -ms-overflow-style: none; scrollbar-width: none; }
* { scrollbar-width: none; }
*::-webkit-scrollbar { width: 0 !important; height: 0 !important; }

/* Allow scrolling in fullscreen on desktop (remove forced overflow hidden) */

/* Page structure */
.page { position: relative; background: #424242; color: #f5f5f5; min-height: 100vh; padding: 0 0 80px; display: flex; flex-direction: column; width: 100%; }

/* Safe-area padding for notches */
.page {
  padding-left: max(0px, env(safe-area-inset-left));
  padding-right: max(0px, env(safe-area-inset-right));
}

/* Hero */
.hero {
  position: relative !important;
  top: auto !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  height: 50vh !important;
  min-height: 0 !important;
  background: none !important; /* image moved to ::before to allow transparency mask */
  margin-bottom: clamp(24px, 4vw, 56px) !important;
}

/* Background image with bottom transparency mask */
.hero::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: calc(var(--hero-bleed) * -1);
  /* Ensure the visible portion is always the center of the image
     even when the pseudo-element extends below the hero. We offset
     the vertical background position upward by half of the bleed. */
  background-image: url('https://static.wixstatic.com/media/b9ad46_c71b6b5da4f54f7583853c3744a28a79~mv2.webp');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center calc(50% - (var(--hero-bleed) / 2));
  z-index: 1;              /* below .hero__fade (2) and content (3) */
  pointer-events: none;
  /* Even more progressive fade into the page background */
  -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,1) 58%, rgba(0,0,0,0) 100%);
  mask-image: linear-gradient(to bottom, rgba(0,0,0,1) 58%, rgba(0,0,0,0) 100%);
  /* optional: smoother GPU hint */
  will-change: mask-image;
}

/* Fade overlay (deduped) */
.hero__fade {
  position: absolute;
  top: 0; left: 0; right: 0; bottom: calc(var(--hero-bleed) * -1);
  pointer-events: none;
  opacity: 1;
  z-index: 2 !important;
  /* Modern bottom blend into the page background (softer, longer) */
  background: linear-gradient(
    to bottom,
    rgba(66,66,66,0) 0%,
    rgba(66,66,66,0.08) 40%,
    rgba(66,66,66,0.20) 60%,
    rgba(66,66,66,0.35) 75%,
    rgba(66,66,66,0.60) 88%,
    #424242 100%
  ) !important;
}
.hero__content { position: relative !important; z-index: 3 !important; }

/* Content */
.hero__content {
  margin: 0 auto !important;
  width: min(92vw, 720px) !important;
  padding: clamp(24px, 5vw, 56px) 24px !important;
  display: flex !important; flex-direction: column !important; align-items: center !important; justify-content: center !important;
  text-align: center !important; gap: clamp(10px, 2.5vw, 22px) !important;
}

/* Title + eyebrow */
.hero__title {
  font-family: 'Playfair Display', serif;
  /* lock size behavior across devices using viewport scaling */
  font-size: clamp(64px, 10vw, 140px) !important;
  letter-spacing: 0.12em !important; text-transform: uppercase; line-height: 1.08;
  margin: 0 !important; max-width: 100%;
  /* Keep title on one line and prevent mid-word breaks */
  white-space: nowrap; word-break: normal; overflow-wrap: normal; hyphens: manual;
  text-shadow: 0 14px 32px rgba(0,0,0,0.35);
  color: #fefff4 !important; /* OSRASE */
}
.hero__eyebrow { white-space: nowrap;  font-size: clamp(0.9rem, 2vw, 1.2rem); letter-spacing: 0.24em; font-weight: 600; line-height: 1.2; }
.hero__content .hero__eyebrow { white-space: nowrap;  margin-bottom: 0; line-height: 1.05; }
.hero__eyebrow + .hero__title { margin-top: calc(-1 * clamp(12px, 3vw, 24px)); }
.hero__eyebrow-primary { color: #ffff80 !important; }   /* SOUND TALES */
.hero__eyebrow-secondary { color: #fefff4 !important; } /* PRODUCTION */
/* Subtle depth for eyebrow text */
.hero__eyebrow,
.hero__eyebrow * { text-shadow: 0 1px 0 rgba(0,0,0,0.16), 0 8px 18px rgba(0,0,0,0.25); }

/* Eyebrow (SOUND TALES PRODUCTION) — force Playfair Display */
.hero__eyebrow,
.hero__eyebrow * {
  font-family: 'Playfair Display', serif !important;
}

/* Meta badges */
.hero__meta {
  display: flex; align-items: center; flex-wrap: wrap;
  gap: clamp(8px, 2vw, 16px); margin-top: clamp(4px, 1vw, 12px);
}
.hero__tag {
  display: inline-flex; align-items: center; white-space: nowrap;
  padding: 8px 14px; font-size: 0.85rem; font-weight: 700; letter-spacing: 0.06em;
  color: #fefff4 !important; background: #424242 !important; border: 1px solid #424242 !important;
  border-radius: 10px; box-shadow: 0 1px 2px rgba(0,0,0,0.22), 0 8px 18px rgba(0,0,0,0.28);
}
.hero__tag.hero__tag--age {
  font-family: 'Libre Baskerville','Baskerville',serif !important;
  font-size: 0.82rem !important;
}

/* Actions */
.hero__actions { display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 28px; }
.hero__cta {
  position: relative !important;
  display: inline-flex !important; align-items: center !important; justify-content: center !important;
  height: 52px !important; padding: 0 62px !important;
  background: var(--cta-bg) !important; color: var(--ink) !important; border: none !important; 
  /* Arrondir les côtés du bouton (style capsule) */
  border-radius: 26px !important;
  font-size: 1.05rem !important; font-weight: 800 !important; letter-spacing: 0.05em !important; text-transform: uppercase !important;
  /* Supprimer l’ancienne forme hexagonale */
  -webkit-clip-path: none !important;
          clip-path: none !important;
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.04);
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
  will-change: transform;
}
/* highlight layer */
.hero__cta::after { content: ''; position: absolute; inset: 0; border-radius: inherit; pointer-events: none; background: linear-gradient(to bottom, rgba(255,255,255,0.22), rgba(255,255,255,0) 42%); mix-blend-mode: soft-light; }
/* Remove pseudo-elements to ensure single-shape CTA */

/* Wedge removed intentionally to avoid extra shape between buttons */
.hero__bookmark {
  position: relative !important;
  height: 52px !important; width: 52px !important; padding: 0 !important;
  display: flex !important; align-items: center !important; justify-content: center !important;
  background: var(--cta-sep-bg) !important; border: none !important; border-radius: 8px !important;
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.04);
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
  will-change: transform;
}
.hero__bookmark-icon { width: 20px !important; height: 20px !important; color: #424242 !important; fill: #424242 !important; }
/* highlight layer */
.hero__bookmark::after { content: ''; position: absolute; inset: 0; border-radius: inherit; pointer-events: none; background: linear-gradient(to bottom, rgba(255,255,255,0.18), rgba(255,255,255,0) 45%); mix-blend-mode: soft-light; }

/* Compact state */
.page--scrolled .hero { height: 45vh !important; min-height: 260px !important; }
.page--scrolled .hero__content {
  position: absolute !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important;
  max-width: min(96vw, 640px) !important; gap: clamp(12px, 3vw, 24px) !important; padding: clamp(24px, 5vw, 48px) 24px !important;
}
.page--scrolled .hero__title { font-size: clamp(1.3rem, 2.3vw, 1.6rem) !important; margin: 0 !important; }
.page--scrolled .hero__cta { height: 52px !important; padding: 0 62px !important; font-size: 1.05rem !important; letter-spacing: 0.05em !important; }
.page--scrolled .hero__bookmark { width: 52px !important; height: 52px !important; }
.page--scrolled .hero__bookmark-icon { width: 20px !important; height: 20px !important; }

/* Cards + gallery */
.card {
  background: #424242; border-radius: 28px; padding: 24px 26px 32px;
  /* Ombres modernisées (plus douces, multi-couches) */
  box-shadow:
    0 1px 2px rgba(0,0,0,0.35),
    0 8px 18px rgba(0,0,0,0.35),
    0 0 0 1px rgba(255,255,128,0.08);
  display: flex; flex-direction: column; gap: 20px; color: #f5f5f5; cursor: pointer;
  transition: transform 220ms ease, box-shadow 220ms ease, filter 220ms ease;
  position: relative;
}
.card:hover { 
  transform: translateY(-4px) scale(1.01);
  box-shadow:
    0 4px 10px rgba(0,0,0,0.35),
    0 16px 36px rgba(0,0,0,0.45),
    0 0 0 1px rgba(255,255,128,0.16);
}
/* Card title: support up to ~40 characters gracefully (2 lines max) */
.card__label {
  color: #fefff4; font-family: 'Playfair Display', serif; text-align: center;
  font-size: 1.5rem; letter-spacing: 0.02em; line-height: 1.25; margin: 0 auto;
  max-width: 92%;
  display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; line-clamp: 2;
  overflow: hidden; text-overflow: ellipsis; word-break: break-word;
  /* reserve space to avoid layout shift when clamped */
  min-height: calc(1.25em * 2);
  text-wrap: balance;
}
/* Modernize the inner elements inside cards (labels, image, badge) */
.card__label {
  font-weight: 600;
  letter-spacing: 0.02em;
  text-shadow: 0 1px 1px rgba(0,0,0,0.5);
}
.card__media { position: relative; border-radius: 22px; overflow: visible; aspect-ratio: 16/9; width: 100%; flex: 1 0 auto; background-size: cover; background-position: center; background-repeat: no-repeat; margin-top: 34px; transition: transform 220ms ease; will-change: transform; }
.card__media::before, .card__media::after, .card__badge::before, .card__badge::after { content: none !important; display: none !important; } /* dedupe */
.card__overlay { position: absolute; inset: 0; background: linear-gradient(180deg, rgba(6,8,15,0.05) 0%, rgba(6,8,15,0.65) 100%); pointer-events: none; transition: opacity 220ms ease; }
.card:hover .card__media { transform: scale(1.02); }
.card:hover .card__overlay { opacity: 0.96; }
.card__badge {
  width: 72px; height: 72px; border-radius: 50%;
  background: #fefff4; color: #1f2023; font-weight: 700; font-size: 1.7rem;
  display: grid; place-items: center;
  border: 2px solid rgba(0,0,0,0.22);
  box-shadow: 0 6px 16px rgba(0,0,0,0.45), 0 0 0 3px rgba(254,255,244,0.7) inset;
  position: absolute; top: 0; left: 50%; transform: translate(-50%, -50%); z-index: 2;
  font-family: 'Libre Baskerville','Baskerville','Playfair Display',serif;
}
.card:hover .card__badge { box-shadow: 0 10px 22px rgba(0,0,0,0.5), 0 0 0 3px rgba(254,255,244,0.85) inset; }

/* Gallery (base: desktop/tablette paysage ? 3 colonnes, cartes plus grandes)
   Place gallery above the extended hero fade */
.gallery { position: relative; z-index: 10 !important; width: min(1220px, 94vw); margin: 0 auto; display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 34px; }
.gallery .card { padding: 22px 26px 28px; gap: 18px; }
.gallery .card__label { margin-top: 6px; font-size: 1.6rem; }
.gallery .card__media { margin-top: 28px; }
.gallery .card__badge { width: 50px; height: 50px; font-size: 1.24rem; border-width: 1.5px; }

/* Media queries (single set) */
@media (min-width: 1400px) {
  .gallery { width: min(1320px, 92vw); gap: 36px; }
  .gallery .card { padding: 28px 32px 36px; gap: 20px; }
  .gallery .card__media { margin-top: 32px; }
}

/* Quickbar (floating buttons on hub) */
.quickbar {
  position: fixed;
  right: max(12px, env(safe-area-inset-right));
  bottom: max(24px, env(safe-area-inset-bottom));
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  z-index: 10060;
  opacity: 0;
  pointer-events: none;
  transition: opacity 220ms ease;
}
.quickbar.is-on { opacity: 1; pointer-events: auto; }
.quickbar.is-off { opacity: 0; pointer-events: none; }
body[data-mode='reader'] .quickbar { display: none !important; }

.qbtn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 52px;
  height: 52px;
  min-width: 52px;
  border-radius: 50%;
  border: 1px solid rgba(255,255,255,0.14);
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)) rgba(32,32,32,0.62);
  color: #fefff4;
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26);
  text-shadow: 0 1px 1px rgba(0,0,0,0.28);
  cursor: pointer;
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease, opacity 220ms ease;
}
.qbtn.is-hidden { opacity: 0; pointer-events: none; }
.qbtn:focus-visible { outline: 2px solid #ffff80; outline-offset: 2px; }
.qbtn:hover { transform: translateY(-2px); box-shadow: var(--shadow-btn-hover); }
.qbtn:active, .qbtn[data-pressed="1"] { transform: translateY(0); box-shadow: var(--shadow-btn-active); }
.qbtn .qicon { display: inline-block; pointer-events: none; font-size: 22px; line-height: 1; }
.qicon--svg { width: 24px; height: 24px; display: block; }
.qbtn--fullscreen svg {
  width: 24px;
  height: 24px;
  stroke: currentColor;
}
.qbtn--fullscreen.is-active {
  background: linear-gradient(180deg, rgba(255,255,255,0.24), rgba(255,255,255,0.08));
  color: #111;
  border-color: rgba(255,255,255,0.4);
  text-shadow: none;
}

@media (max-width: 768px) {
  .qbtn { width: 52px; height: 52px; }
}

/* Bookmarks panel (hub) */
.bm-mask {
  position: fixed;
  inset: 0;
  /* Keep mask under quickbar so it never covers quickbar buttons */
  z-index: 10050;
  /* Do NOT dim page when bookmarks open */
  background: transparent;
}
.bm-panel {
  position: fixed;
  left: var(--bm-left, auto);
  top: var(--bm-top, auto);
  /* default transform and animated origin */
  --bm-transform: translate(-50%, 0);
  transform: var(--bm-transform);
  width: min(92vw, 360px);
  background: #1f2023;
  color: #fefff4;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.12);
  overflow: hidden;
  z-index: 10055; /* above mask, below quickbar */
  animation: bm-in-grow 160ms ease-out both;
}
/* Side variants */
.bm-panel.bm--bottom { --bm-transform: translate(-50%, 0); transform-origin: 50% 0%; }
.bm-panel.bm--left { --bm-transform: translate(calc(-100% - 8px), -50%); right: auto; transform-origin: 100% 50%; }
.bm-panel.bm--right { --bm-transform: translate(0, -50%); transform-origin: 0% 50%; }
/* Connector arrow */
.bm-panel::before {
  content: '';
  position: absolute;
  width: 14px; height: 14px;
  background: #1f2023;
  box-shadow: -1px -1px 0 0 rgba(255,255,255,0.12);
  transform: rotate(45deg);
}
.bm-panel.bm--bottom::before { left: 50%; top: -7px; transform: translateX(-50%) rotate(45deg); }
.bm-panel.bm--left::before { right: -7px; top: 50%; transform: translateY(-50%) rotate(45deg); }
.bm-panel.bm--right::before { left: -7px; top: 50%; transform: translateY(-50%) rotate(45deg); }
.bm-list { max-height: 60vh; overflow: auto; }

/* Mobile phones portrait */
@media (max-width: 480px) and (orientation: portrait) {
  .bm-panel { width: min(96vw, 420px); border-radius: 14px; }
  .bm-panel.bm--left { width: min(86vw, 320px); }
  .bm-list { max-height: 56vh; }
}

/* Tablets portrait */
@media (min-width: 481px) and (max-width: 1024px) and (orientation: portrait) {
  .bm-panel { width: min(92vw, 420px); }
  .bm-panel.bm--left { width: min(80vw, 360px); }
  .bm-list { max-height: 60vh; }
}
.bm-head { display: flex; align-items: center; justify-content: space-between; padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.1); }
.bm-title { font-weight: 800; letter-spacing: .04em; }
.bm-close { all: unset; cursor: pointer; font-size: 20px; line-height: 1; padding: 6px 8px; }
.bm-list { display: flex; flex-direction: column; max-height: 60vh; overflow: auto; }
.bm-empty { padding: 14px; opacity: .8; }
.bm-item { all: unset; cursor: pointer; display: flex; align-items: center; justify-content: space-between; gap: 10px; padding: 12px 14px; }
.bm-item:hover { background: rgba(255,255,255,0.06); }
.bm-label { font-weight: 700; letter-spacing: .02em; }
.bm-badge { min-width: 28px; height: 28px; border-radius: 999px; background: #FEFFF4; color: #1f2023; font-weight: 800; display: inline-grid; place-items: center; }
@keyframes bm-in-grow { from { transform: var(--bm-transform) scale(0.96); opacity: 0; } to { transform: var(--bm-transform) scale(1); opacity: 1; } }

@media (max-width: 900px) {
  .hero__content {
    padding: clamp(24px, 5vw, 48px);
    max-width: 96vw;
    gap: clamp(10px, 2vw, 18px);
    align-items: center;
    text-align: center;
  }
}

@media (max-width: 768px) {
  .hero { padding: 32px 16px; }
  .hero__content { padding: 32px 20px; gap: 16px; }
  .hero__title { font-size: clamp(2.8rem, 10vw, 4rem); text-align: center; }
  /* Tablet portrait ? 2 colonnes pour agrandir les cartes */
  .gallery { width: min(980px, 94vw); grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 28px; }
}

@media (max-width: 480px) {
  .hero { padding: 24px 16px; height: 62vh !important; }
  .hero__content { padding: 28px 16px; gap: 14px; }
  .hero__title { font-size: clamp(56px, 18vw, 96px) !important; }
  .hero__meta { gap: 8px; }
  .hero__tag { padding: 6px 14px; font-size: 0.8rem; }
  /* Keep hero buttons identical on small screens */
  .hero__actions { gap: 10px; margin-top: 22px; flex-wrap: nowrap; }
  .hero__cta { height: 56px !important; padding: 0 48px !important; min-width: clamp(240px, 74vw, 520px); font-size: 1.05rem !important; }
  .hero__bookmark { width: 56px !important; height: 56px !important; }
  /* Mobile ? 1 colonne, cartes larges */
  .gallery { width: 94vw; gap: 32px; margin-top: 36px; grid-template-columns: 1fr; }
}

/* Force consistent centered layout across all devices */
.hero { justify-content: center !important; }
.hero__content {
  align-items: center !important;
  text-align: center !important;
  margin-left: auto !important;
  margin-right: auto !important;
  width: min(92vw, 720px) !important;
  left: auto !important; transform: none !important;
}

/* Keep same layout even for page--scrolled state */
.page--scrolled .hero { height: 50vh !important; }
.page--scrolled .hero__content {
  position: relative !important; top: auto !important; left: auto !important; transform: none !important;
  align-items: center !important; text-align: center !important; margin: 0 auto !important;
}

/* Skip link (visible on focus) */
.skip-link {
  position: absolute;
  top: 8px;
  left: 8px;
  z-index: 1000;
  padding: 10px 14px;
  background: #ffff80;
  color: #000;
  border-radius: 10px;
  text-decoration: none;
  transform: translateY(-120%);
  transition: transform 0.2s ease;
}
.skip-link:focus,
.skip-link:focus-visible {
  transform: translateY(0);
  outline: 3px solid #000;
  outline-offset: 2px;
}

/* Focus-visible outlines for interactive elements */
.hero__cta:focus-visible,
.hero__bookmark:focus-visible,
.card:focus-visible {
  outline: 3px solid #ffff80;
  outline-offset: 3px;
  border-radius: 12px;
}

/* Subtle hover/active feedback */
.hero__cta,
.hero__bookmark {
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
}
.hero__cta:hover,
.hero__bookmark:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-btn-hover);
}
.hero__cta:active,
.hero__bookmark:active {
  transform: translateY(0);
  box-shadow: var(--shadow-btn-active);
}
@media (hover: none) {
  .card:hover .card__media { transform: none; }
  .card:hover .card__overlay { opacity: 1; }
  .hero__cta:hover,
  .hero__bookmark:hover { transform: none; box-shadow: none; }
}

/* Visual state when bookmarked */
.hero__bookmark.is-bookmarked,
.hero__bookmark[aria-pressed="true"] {
  background: #ffff80 !important;
  color: #000 !important;
}
.hero__bookmark.is-bookmarked .hero__bookmark-icon,
.hero__bookmark[aria-pressed="true"] .hero__bookmark-icon {
  color: #000 !important;
  fill: #000 !important;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  * {
    animation: none !important;
    transition-duration: 0.01ms !important;
    transition-delay: 0ms !important;
  }
  .card:hover,
  .hero__cta:hover,
  .hero__bookmark:hover {
    transform: none !important;
    box-shadow: none !important;
  }
}
/* Tablet portrait adjustments (600px-1024px, portrait) */
@media (min-width: 600px) and (max-width: 1024px) and (orientation: portrait) {
  .hero { height: 50vh !important; }
  .hero__content { width: min(88vw, 760px) !important; gap: 18px; }
  .hero__title { font-size: clamp(72px, 10vw, 110px) !important; }
  .hero__actions { gap: 10px; }
  .hero__cta { height: 56px !important; padding: 0 72px !important; min-width: clamp(260px, 42vw, 420px); }
  .hero__bookmark { width: 56px !important; height: 56px !important; }
  /* Tablet portrait ? 2 colonnes pour cartes plus grandes */
  .gallery { width: min(980px, 94vw); grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 28px; }
  .gallery .card { padding: 22px 26px 28px; }
}

@media (min-width: 768px) and (orientation: landscape) {
  .hero { height: 50vh !important; justify-content: flex-start !important; }
  .hero__content {
    align-items: flex-start !important;
    text-align: left !important;
    margin-left: clamp(48px, 8vw, 120px) !important;
    margin-right: auto !important;
    width: min(560px, 46vw) !important;
    margin-top: clamp(20px, 6vh, 72px) !important;
  }
  .hero__title { font-size: clamp(64px, 8.5vw, 110px) !important; }
  .hero__actions { justify-content: flex-start; gap: 8px; margin-top: 18px; }
  .hero__cta { height: 52px !important; padding: 0 60px !important; }
  .hero__bookmark { width: 52px !important; height: 52px !important; }
  /* Tablette paysage / Desktop par défaut ? 3 colonnes, plus grands */
  .gallery { width: min(1220px, 94vw); grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 34px; }
}

/* Desktop (>= 1025px) */
@media (min-width: 1025px) {
  .hero { height: 48vh !important; justify-content: flex-start !important; }
  .hero__content {
    align-items: flex-start !important;
    text-align: left !important;
    margin-left: clamp(60px, 8vw, 140px) !important;
    margin-right: auto !important;
    width: min(600px, 44vw) !important;
  }
  .hero__title { font-size: clamp(72px, 7.8vw, 120px) !important; }
  .hero__actions { justify-content: flex-start; gap: 8px; margin-top: 20px; }
  .hero__cta { height: 52px !important; padding: 0 64px !important; }
  .hero__bookmark { width: 52px !important; height: 52px !important; }
  .gallery { width: min(1320px, 92vw); grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 36px; }
}

/* Floating actions bar (appears when hero actions are off-screen) */
.fab {
  position: fixed !important;
  left: 50%; bottom: max(16px, env(safe-area-inset-bottom));
  transform: translateX(-50%);
  display: flex; gap: 10px; align-items: center; flex-wrap: nowrap; justify-content: center;
  padding: 0; /* no surrounding background */
  background: transparent;
  box-shadow: none;
  border-radius: 0;
  z-index: 10000;
  /* smooth appear */
  opacity: 0;
  animation: fab-fade-in 360ms ease-out forwards;
  /* Improve reliability of fixed on mobile/WebViews */
  will-change: transform;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  pointer-events: auto;
  /* Keep inside viewport width and avoid overflow */
  max-width: calc(100vw - 32px - env(safe-area-inset-left) - env(safe-area-inset-right));
  width: max-content;
  min-width: 0;
}
.fab .hero__cta { height: 48px !important; padding: 0 28px !important; white-space: nowrap; }
.fab .hero__bookmark { width: 48px !important; height: 48px !important; }

@media (min-width: 768px) {
  .fab {
    left: auto; right: 24px; transform: none;
    bottom: max(24px, env(safe-area-inset-bottom));
  }
}

/* Strengthen fixed positioning behavior on iOS/WebViews */
@supports (-webkit-touch-callout: none) {
  .fab {
    position: fixed !important;
  }
}

/* Phone landscape: reduce hero size and avoid overlaps; make gallery 2 cols */
@media (max-width: 896px) and (orientation: landscape) {
  :root { --hero-bleed: 120px; }
  .hero { height: 42vh !important; }
  .hero__content { width: min(92vw, 640px) !important; gap: 12px; margin-top: clamp(16px, 6vh, 56px) !important; }
  .hero__title { font-size: clamp(40px, 9vw, 72px) !important; }
  .hero__actions { gap: 8px; margin-top: 12px; }
  .hero__cta { height: 48px !important; padding: 0 48px !important; }
  .hero__bookmark { width: 48px !important; height: 48px !important; }
  .gallery { width: 96vw; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 22px; margin-top: 20px; }
}

/* Mobile: center FAB and guarantee in-frame width */
@media (max-width: 768px) {
  .fab {
    left: 50%;
    transform: translateX(-50%);
    width: calc(100vw - 24px - env(safe-area-inset-left) - env(safe-area-inset-right));
    max-width: calc(100vw - 24px - env(safe-area-inset-left) - env(safe-area-inset-right));
    padding: 0 8px;
    box-sizing: border-box;
    gap: 8px;
  }
  .fab .hero__cta { flex: 1 1 auto; min-width: 0; max-width: 100%; }
  .fab .hero__bookmark { flex: 0 0 auto; }
}

/* Very short viewports: ensure FAB stays inside vertically */
@media (max-height: 480px) {
  .fab { bottom: max(8px, env(safe-area-inset-bottom)); }
  .fab .hero__cta { height: 44px !important; padding: 0 24px !important; }
  .fab .hero__bookmark { width: 44px !important; height: 44px !important; }
}

/* Tiny landscape heights: further reduce */
@media (orientation: landscape) and (max-height: 420px) {
  .fab { bottom: max(6px, env(safe-area-inset-bottom)); }
  .fab .hero__cta { height: 40px !important; padding: 0 20px !important; }
  .fab .hero__bookmark { width: 40px !important; height: 40px !important; }
}

@keyframes fab-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Launch gate (fullscreen intro) */
.gate {
  position: fixed; inset: 0; z-index: 100000;
  background: #424242;
  display: grid; place-items: center;
  /* Ensure full dynamic viewport coverage to avoid bottom flash */
  width: 100vw; height: 100svh; height: 100dvh; height: 100lvh; min-height: 100lvh;
  /* Block any scroll/overscroll while gate is shown */
  overflow: hidden; overscroll-behavior: none; touch-action: none;
  /* Force hardware acceleration for better performance in in-app browsers */
  transform: translateZ(0); will-change: opacity;
  contain: layout paint;
  padding: 0;
}

/* Lock layout during gate to prevent any underlying shift */
html.gate-lock, body.gate-lock {
  position: fixed; inset: 0; overflow: hidden; width: 100%; height: 100dvh;
}
/* While locked, hide hub underlay to avoid any incidental paint */
body.gate-lock .page { visibility: hidden !important; }

/* Vignette respirante (halo radial très léger) */
/* Remove decorative vignette during gate to ensure perfectly uniform background */
.gate::before { content: none !important; }

/* In-app browser banner: suggest opening in system browser */
.iab-banner {
  position: fixed;
  top: max(10px, env(safe-area-inset-top));
  left: 50%;
  transform: translateX(-50%);
  z-index: 10050;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
  justify-content: center;
  background: rgba(30, 30, 30, 0.75);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 12px;
  padding: 12px;
  max-width: calc(100vw - 24px - env(safe-area-inset-left) - env(safe-area-inset-right));
}
.iab-text {
  color: #fefff4;
  font-family: 'Playfair Display', serif;
  font-size: clamp(14px, 3.4vw, 16px);
  text-align: center;
  letter-spacing: 0.02em;
  line-height: 1.35;
  margin: 0;
}
.iab-btn {
  all: unset;
  cursor: pointer;
  background: var(--cta-bg);
  color: var(--ink);
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  letter-spacing: 0.06em;
  padding: 10px 16px;
  border-radius: 12px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.04);
}
.iab-btn--ghost {
  background: transparent;
  color: #fefff4;
  border: 1px solid rgba(255,255,255,0.28);
}
.iab-banner--compact {
  position: sticky;
  top: 0;
  left: 0; right: 0;
  transform: none;
  margin: 6px auto;
  background: rgba(30,30,30,0.7);
  padding: 6px 10px;
  gap: 0;
}
.iab-banner--compact .iab-btn { padding: 6px 10px; font-size: 0.92rem; }
.iab-actions { display: flex; gap: 10px; }
@media (max-width: 420px) {
  .iab-actions { flex-direction: column; width: 100%; }
  .iab-actions .iab-btn { text-align: center; }
}
@media (min-width: 769px) {
  .iab-banner { display: none; }
}

/* Make the interactive layer fully cover with the same solid background */
.gate__hit {
  all: unset;
  cursor: pointer;
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  background: #424242; /* same as .gate background */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: clamp(12px, 4vh, 28px);
  /* keep content clear of notches and home indicators; make left/right symmetric so visual center stays true */
  padding-top:    max(16px, env(safe-area-inset-top));
  padding-bottom: max(20px, env(safe-area-inset-bottom));
  padding-left:   max(16px, max(env(safe-area-inset-left),  env(safe-area-inset-right)));
  padding-right:  max(16px, max(env(safe-area-inset-left),  env(safe-area-inset-right)));
  text-align: center;
  /* compensate asymmetric safe-area insets (e.g., landscape notch) to keep true viewport center */
  transform: translateX(calc((env(safe-area-inset-right) - env(safe-area-inset-left)) / 2));
  will-change: transform;
  /* Enhanced touch handling for in-app browsers */
  -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
}
.gate__msg {
  position: static;
  left: auto; top: auto; transform: none;
  font-family: 'Playfair Display', serif; text-align: center; max-width: min(90vw, 640px);
  font-size: clamp(18px, 5vw, 32px); line-height: 1.25; letter-spacing: 0.04em;
  color: #fefff4; opacity: 1; transition: opacity .6s ease;
  padding: 0 12px;
  margin: 0 auto;
}
.gate__logo {
  position: static;
  left: auto; top: auto; transform: scale(0.975);
  display: block; margin: 0 auto; height: auto; opacity: 0; /* start hidden for fade-in */
  width: clamp(140px, min(52vw, 36vh), 360px); /* proportionnel à l'écran, borne min/max */
  max-width: min(380px, calc(100vw - 48px));
  max-height: min(44vh, 44dvh);
  transition: opacity 2000ms cubic-bezier(0.16,1,0.3,1), filter 2000ms cubic-bezier(0.16,1,0.3,1);
  will-change: opacity, transform, filter;
  filter: drop-shadow(0 10px 30px rgba(0,0,0,0.6)) blur(0.6px);

  user-select: none; -webkit-user-select: none; pointer-events: none; -webkit-user-drag: none;
}

/* Bookmark (signet) button on chapter cards */
.card__fav {
  position: absolute; top: 10px; right: 10px;
  width: 36px; height: 36px; border-radius: 18px;
  display: inline-flex; align-items: center; justify-content: center;
  background: rgba(255,255,255,0.08); color: #fefff4; border: 1px solid rgba(255,255,255,0.2);
  box-shadow: 0 2px 10px rgba(0,0,0,0.35);
}
.card__fav.is-on { background: #ffff80; color: #1f2023; border-color: #1f2023; font-weight: 800; }
.card__fav:focus-visible { outline: 2px solid #ffff80; outline-offset: 2px; }

/* Very small height (landscape phones): reduce sizes a bit */
@media (max-height: 560px) {
  .gate__hit { gap: clamp(8px, 3vh, 18px); }
  .gate__msg { font-size: clamp(16px, 4vw, 24px); }
  .gate__logo { max-height: 32vh; width: clamp(120px, min(42vw, 28vh), 300px); }
}
.gate__logo svg { display:block; width:100%; height:auto; color: inherit; }
.gate__logo [fill]:not([fill="none"]) { fill: currentColor; }
.gate__logo [stroke]:not([stroke="none"]) { stroke: currentColor; }
.gate.is-starting .gate__msg { opacity: 0; transform: none; }
.gate.is-starting .gate__logo { opacity: 1; }
.gate.is-finishing .gate__msg, .gate.is-finishing .gate__logo { opacity: 0; }
.gate.is-finishing { opacity: 0; transition: opacity 360ms ease; }
.gate.is-logo .gate__msg { display: none !important; }
.gate.is-logo .gate__logo { opacity: 1 !important; filter: drop-shadow(0 10px 30px rgba(0,0,0,0.6)) blur(0); animation: gate-zoom 7000ms cubic-bezier(0.16,1,0.3,1) forwards; transform-origin: 50% 50%; }
@keyframes gate-zoom {
  0% { transform: scale(0.98); }
  100% { transform: scale(1.02); }
}

/* =============================
   Gate Centering Overrides (final)
   ============================= */
.gate__hit { padding: 0 !important; transform: none !important; }
.gate__center {
  position: absolute; left: 50%; top: 0; bottom: 0; transform: translateX(-50%);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: clamp(12px, 4vh, 28px);
  padding-top: max(16px, env(safe-area-inset-top));
  padding-bottom: max(20px, env(safe-area-inset-bottom));
  padding-left:   max(16px, max(env(safe-area-inset-left),  env(safe-area-inset-right)));
  padding-right:  max(16px, max(env(safe-area-inset-left),  env(safe-area-inset-right)));
  width: 100%; text-align: center;
}
.gate__msg {
  position: static !important; left: auto !important; top: auto !important; transform: none !important;
  margin-left: auto !important; margin-right: auto !important;
  max-width: min(90vw, 640px) !important;
}
.gate__logo {
  position: static !important; left: auto !important; top: auto !important; transform: none !important;
  display: block !important; margin-left: auto !important; margin-right: auto !important;
  transform-origin: 50% 50% !important;
  width: clamp(140px, min(52vw, 36vh), 360px) !important;
  max-width: min(380px, calc(100vw - 48px)) !important;
  max-height: min(44vh, 44dvh) !important;
}
/* When inline SVG is used */
.gate__logo svg { display:block; width:100%; height:auto; color: inherit; }
.gate__logo [fill]:not([fill="none"]) { fill: currentColor; }
.gate__logo [stroke]:not([stroke="none"]) { stroke: currentColor; }
.gate.is-starting .gate__msg { opacity: 0; transform: none; }
.gate.is-starting .gate__logo { opacity: 1; }
.gate.is-finishing .gate__msg, .gate.is-finishing .gate__logo { opacity: 0; }
.gate.is-finishing { opacity: 0; transition: opacity 360ms ease; }
/* Instant logo state: no fade/crossfade, message hidden */
.gate.is-logo .gate__msg { display: none !important; }
.gate.is-logo .gate__logo { opacity: 1 !important; filter: drop-shadow(0 10px 30px rgba(0,0,0,0.6)) blur(0); animation: gate-zoom 7000ms cubic-bezier(0.16,1,0.3,1) forwards; transform-origin: 50% 50%; }
@keyframes gate-zoom {
  0% { transform: scale(0.98); }
  100% { transform: scale(1.02); }
}

/* When fading out, let scroll/pan pass through immediately */
.gate.is-finishing { pointer-events: none; }

/* Media queries adjustments for gate logo */
/* logo sizing already proportional; media blocks no longer required *//* Better mobile scroll prevention with special in-app browser handling */
.no-scroll { 
  overflow: hidden !important; 
  height: 100vh; 
  height: 100dvh; /* Dynamic viewport height for better mobile support */
  /* More gentle approach for in-app browsers */
  position: relative;
  width: 100%;
  /* Prevent scroll chaining but allow some flexibility */
  overscroll-behavior: contain;
}

/* Only apply aggressive scroll prevention on standard browsers */
@media (min-width: 769px) {
  .no-scroll {
    position: fixed;
    -webkit-overflow-scrolling: auto;
    overscroll-behavior: none;
  }
}

/* Mobile-specific improvements with enhanced in-app browser support */
@media (max-width: 768px) {
  .gate {
    position: fixed;
    /* Better touch handling on mobile */
    -webkit-overflow-scrolling: touch;
    /* Less aggressive overscroll for in-app browsers */
    overscroll-behavior: auto;
    /* Enhanced performance for in-app browsers */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
  
  .gate__hit {
    /* Improve touch target */
    min-height: 44px;
    /* Prevent text selection on mobile */
    -webkit-user-select: none;
    user-select: none;
    /* Better touch feedback for in-app browsers */
    -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
    /* Allow scroll gestures to pass through when appropriate */
    touch-action: pan-y;
    /* Enhanced interaction area for in-app browsers */
    padding: 20px;
  }
  
  /* Ensure mobile viewport works well in all contexts */
  .page {
    min-height: 100vh;
    min-height: -webkit-fill-available;
    min-height: 100dvh;
    /* Allow scroll in embedded contexts */
    overscroll-behavior: auto;
  }

  /* Less aggressive fixes for in-app browsers */
  body {
    /* Allow natural scrolling in in-app browsers */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: auto;
  }

  /* Minimal intervention for WebView compatibility */
  html {
    overflow-x: hidden;
    -webkit-text-size-adjust: 100%;
  }
  
  /* Special handling when no-scroll is active on mobile */
  body.no-scroll {
    /* Gentler scroll prevention for mobile/in-app */
    overflow: hidden;
    position: relative;
    height: 100vh;
    /* Don't use fixed positioning on mobile */
  }
}

/* Enhanced adjustments for WebView contexts */
@supports (-webkit-touch-callout: none) {
  .gate {
    /* iOS WebView specific fixes */
    -webkit-overflow-scrolling: touch;
    /* Better performance in WebViews */
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }
  
  .gate__hit {
    /* Enhanced touch response in WebViews */
    -webkit-tap-highlight-color: rgba(255, 255, 255, 0.05);
    /* Better interaction handling but allow scroll */
    -webkit-touch-callout: none;
    touch-action: manipulation;
  }
  
  .no-scroll {
    /* Less aggressive scroll prevention on iOS WebView */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: auto;
    /* Don't use fixed positioning in WebViews */
    position: relative !important;
  }
}

/* Special handling for known in-app browsers */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  /* Detect WebKit browsers (includes most in-app browsers) */
  .no-scroll {
    /* Minimal scroll intervention */
    overflow-y: auto;
    position: relative;
    /* Allow momentum scrolling */
    -webkit-overflow-scrolling: touch;
  }
  
  .gate {
    /* Ensure gate works without breaking scroll */
    overscroll-behavior: auto;
  }
}

/* Force-mobile layout override after exiting fullscreen */
body.force-mobile .gallery { grid-template-columns: 1fr !important; width: 94vw !important; gap: 32px !important; }
body.force-mobile .hero { padding: 24px 16px !important; height: 62vh !important; justify-content: center !important; }

/* Reader splash (transition from hub to reader) */
.reader-splash {
  position: fixed; inset: 0; z-index: 2000;
  display: grid; place-items: center;
  padding: max(16px, env(safe-area-inset-top)) max(16px, env(safe-area-inset-right)) max(24px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left));
  animation: splash-bg 200ms cubic-bezier(0,0,0.2,1) forwards;
}
.reader-splash.theme-dark { background: #424242; color: #fefff4; }
.reader-splash.theme-light { background: #fefff4; color: #424242; }
.reader-splash__card { width: min(560px, 68vw); margin-left: auto; margin-right: auto; }
.reader-splash__img { width: 100%; aspect-ratio: 16/9; border-radius: 16px; display: block; box-shadow: 0 10px 30px rgba(0,0,0,0.25); opacity: 0; }
.reader-splash__line { margin-top: clamp(18px, 3.6vw, 28px); display: flex; align-items: baseline; gap: 12px; opacity: 0; transform: translateY(8px); }
.reader-splash__badge { display: inline-grid; place-items: center; width: 22px; height: 22px; border-radius: 50%; font-weight: 700; font-size: 0.9rem; }
.reader-splash.theme-light .reader-splash__badge { background: #424242; color: #fefff4; }
.reader-splash.theme-dark .reader-splash__badge { background: #fefff4; color: #424242; }
.reader-splash__label { display: none; }
.reader-splash__title { font-family: 'Playfair Display', serif; font-weight: 700; letter-spacing: 0.02em; }

.simple .reader-splash__img { animation: splash-img 500ms cubic-bezier(0.16,1,0.3,1) 150ms forwards; }
.simple .reader-splash__line { animation: splash-line 450ms cubic-bezier(0.16,1,0.3,1) 300ms forwards; }
.phase-exit { animation: splash-exit 350ms cubic-bezier(0.4,0,1,1) both; }

@keyframes splash-bg { from { opacity: 0; } to { opacity: 1; } }
@keyframes splash-img { from { opacity: 0; transform: translateY(12px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
@keyframes splash-line { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes splash-exit { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-12px); } }

@media (prefers-reduced-motion: reduce) {
  .reader-splash { animation-duration: 200ms; }
  .phase-wipe .reader-splash__label::after { animation-duration: 480ms; }
  .phase-title .reader-splash__title, .phase-wait .reader-splash__title { animation-duration: 480ms; }
  .phase-exit { animation-duration: 350ms; }
}

/* Reader base */
.reader {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  --reader-light: #fefff4;
  --reader-dark: #424242;
  --reader-black: #000000;
  --reader-accent: #ffff80;
  --reader-ink-light: #424242;
  --reader-ink-dark: #fefff4;
  --reader-muted-light: rgba(0,0,0,0.64);
  --reader-muted-dark: rgba(254,255,244,0.72);
  --reader-surface-light: rgba(254,255,244,0.92);
  --reader-surface-dark: rgba(0,0,0,0.38);
  --reader-border-light: rgba(0,0,0,0.18);
  --reader-border-dark: rgba(254,255,244,0.32);
  --reader-panel-light: rgba(254,255,244,0.86);
  --reader-panel-dark: rgba(0,0,0,0.52);
  --reader-rail-track-light: linear-gradient(180deg, rgba(0,0,0,0.08) 0%, rgba(0,0,0,0.32) 100%);
  --reader-rail-track-dark: linear-gradient(180deg, rgba(254,255,244,0.18) 0%, rgba(0,0,0,0.45) 100%);
  --reader-voice-fill-light: rgba(0,0,0,0.5);
  --reader-voice-fill-dark: rgba(254,255,244,0.75);
  --reader-dialog-indicator-idle: var(--reader-black);
  --reader-dialog-indicator-read: rgba(66,66,66,0.5);
  --reader-dialog-accent: rgba(255,255,128,0.4);
  --reader-dialog-accent-text: var(--reader-dark);
  --reader-potard-track: rgba(0,0,0,0.3);
  --reader-potard-text: #000000;
  --reader-dock-pill-bg: #424242;
  --reader-dock-pill-fg: #fefff4;
  --reader-dock-pill-active-bg: #ffff80;
  --reader-dock-pill-active-fg: #000000;
  --reader-dock-circle-bg: #424242;
  --reader-dock-circle-fg: #fefff4;
  --reader-dock-circle-active-bg: #ffff80;
  --reader-dock-circle-active-fg: #000000;
  --reader-dock-muted: rgba(0,0,0,0.4);
  --reader-shadow: 0 22px 44px rgba(0,0,0,0.55);
  --reader-transition: 220ms cubic-bezier(0.16,1,0.3,1);
  --reader-panel-radius: 28px;
  --reader-overlay-spacing: clamp(12px, 5vw, 24px);
  --reader-overlay-gap: clamp(12px, 4vw, 20px);
  --reader-control-height: clamp(44px, 6vw, 52px);
  --reader-focus: #ffff80;
  --reader-page-width: min(640px, 90vw);
  --reader-bg: var(--reader-light);
  --reader-ink: var(--reader-ink-light);
  --reader-muted: var(--reader-muted-light);
  --reader-surface: var(--reader-surface-light);
  --reader-border: var(--reader-border-light);
  --reader-panel-bg: var(--reader-panel-light);
  --reader-rail-track: var(--reader-rail-track-light);
  --reader-rail-fill: var(--reader-accent);
  --reader-voice-fill: var(--reader-voice-fill-light);
  --reader-dialog-active: #000000;
  --reader-font-base: 18px;
  --reader-font-delta: 0px;
  --reader-bottom-ui: clamp(150px, 20vh, 260px);
  background: var(--reader-bg);
  color: var(--reader-ink);
  font-variant-numeric: lining-nums;
  font-synthesis: none;
  transition: background-color var(--reader-transition), color var(--reader-transition);
  -webkit-user-select: none;
  user-select: none;
}
.reader[data-theme='dark'] {
  --reader-bg: var(--reader-dark);
  --reader-ink: var(--reader-ink-dark);
  --reader-muted: var(--reader-muted-dark);
  --reader-surface: var(--reader-surface-dark);
  --reader-border: var(--reader-border-dark);
  --reader-panel-bg: var(--reader-panel-dark);
  --reader-rail-track: var(--reader-rail-track-dark);
  --reader-voice-fill: var(--reader-voice-fill-dark);
  --reader-shadow: 0 32px 56px rgba(0,0,0,0.75);
  --reader-dialog-indicator-idle: #ffff80;
  --reader-dialog-indicator-read: rgba(254,255,244,0.5);
  --reader-dialog-accent: rgba(0,0,0,0.72);
  --reader-dialog-accent-text: #fefff4;
  --reader-dialog-active: #ffff80;
  --reader-potard-track: rgba(254,255,244,0.3);
  --reader-potard-text: #fefff4;
  --reader-dock-pill-bg: #fefff4;
  --reader-dock-pill-fg: #424242;
  --reader-dock-pill-active-bg: #000000;
  --reader-dock-pill-active-fg: #fefff4;
  --reader-dock-circle-bg: #fefff4;
  --reader-dock-circle-fg: #424242;
  --reader-dock-circle-active-bg: #000000;
  --reader-dock-circle-active-fg: #fefff4;
  --reader-dock-muted: rgba(254,255,244,0.4);
  --reader-focus: #000000;
}
.reader[data-theme='dark'] .para { color: var(--reader-ink); }

.reader button:focus-visible,
.reader [role="button"]:focus-visible {
  outline: 3px solid var(--reader-focus);
  outline-offset: 3px;
}

@media (min-width: 768px) {
  .reader {
    --reader-font-base: 20px;
  }
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.reader__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px clamp(16px, 5vw, 28px);
  gap: 12px;
}
.reader__header-left {
  display: flex;
  align-items: center;
  gap: 10px;
}
.reader__back,
.reader__fullscreen {
  border: 1px solid var(--reader-border);
  background: var(--reader-surface);
  color: var(--reader-ink);
  padding: 8px 16px;
  border-radius: 999px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  cursor: pointer;
  transition: background-color var(--reader-transition), color var(--reader-transition), border-color var(--reader-transition);
}
.reader__fullscreen {
  width: 40px;
  height: 40px;
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.reader__fullscreen svg {
  width: 20px;
  height: 20px;
}
.reader__header-right {
  display: inline-flex;
  align-items: center;
  justify-content: flex-end;
  flex-wrap: wrap;
  gap: clamp(12px, 3vw, 20px);
}
.reader__header-center {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}
.reader__book {
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  letter-spacing: 0.02em;
}
.reader__page {
  font-size: 12px;
  color: var(--reader-muted);
  font-family: 'Libre Baskerville','Playfair Display',serif;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.reader__text-stack {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: clamp(10px, 2vw, 16px);
}
.reader__text-row {
  display: flex;
  align-items: center;
  gap: clamp(10px, 2vw, 18px);
}
.reader__bookmark {
  width: var(--reader-control-height);
  height: var(--reader-control-height);
  border-radius: calc(var(--reader-control-height) / 2);
  border: 1px solid #424242;
  background: transparent;
  color: #424242;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform 120ms ease, background-color var(--reader-transition), color var(--reader-transition), border-color var(--reader-transition);
}
.reader__bookmark.is-on {
  background: #000000;
  color: #FEFFF4;
  border-color: #000000;
}
.reader[data-theme='dark'] .reader__bookmark {
  border-color: #FEFFF4;
  color: #FEFFF4;
}
.reader[data-theme='dark'] .reader__bookmark.is-on {
  background: #FFFF80;
  color: #000000;
  border-color: #FFFF80;
}
.reader__bookmark.has-pulse {
  animation: readerBookmarkPulse 420ms ease;
}
.reader__bookmark:active,
.reader__theme-toggle:active {
  transform: scale(0.98);
}
.reader__bookmark-icon {
  width: 20px;
  height: 20px;
  display: block;
}
.reader__text-pill {
  display: flex;
  align-items: stretch;
  border-radius: var(--reader-control-height);
  border: 1px solid #424242;
  background: #424242;
  color: #FEFFF4;
  height: var(--reader-control-height);
  overflow: hidden;
}
.reader[data-theme='dark'] .reader__text-pill {
  border-color: #FEFFF4;
  background: #FEFFF4;
  color: #424242;
}
.reader__text-pill.is-boost {
  background: #FFFF80;
  border-color: #FFFF80;
  color: #000000;
}
.reader__segment {
  flex: 1;
  border: 0;
  background: transparent;
  color: inherit;
  font-weight: 600;
  font-size: 0.95rem;
  letter-spacing: 0.08em;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 120ms ease, color 120ms ease, transform 80ms ease;
}
.reader__segment.is-active {
  background: #FFFF80;
  color: #000000;
}
.reader[data-theme='dark'] .reader__segment.is-active {
  background: #000000;
  color: #FEFFF4;
}
.reader__text-pill.is-boost .reader__segment {
  color: #000000;
}
.reader__text-pill.is-boost .reader__segment.is-active {
  background: transparent;
}
.reader__segment:active {
  transform: scale(0.98);
}
.reader__segment-sep {
  width: 1px;
  background: rgba(0,0,0,0.3);
  margin: calc(var(--reader-control-height) * 0.18) 0;
}
.reader[data-theme='dark'] .reader__segment-sep {
  background: rgba(254,255,244,0.3);
}
.reader__text-pill.is-boost .reader__segment-sep {
  background: rgba(0,0,0,0.35);
}
.reader__theme-toggle {
  width: var(--reader-control-height);
  height: var(--reader-control-height);
  border-radius: calc(var(--reader-control-height) / 2);
  border: 1px solid #424242;
  background: #424242;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform 120ms ease, background-color var(--reader-transition), border-color var(--reader-transition);
}
.reader[data-theme='dark'] .reader__theme-toggle {
  border-color: #FEFFF4;
  background: #FEFFF4;
}
.reader__theme-toggle img {
  width: 22px;
  height: 22px;
  display: block;
}
.reader__overlay-btn {
  border: 1px solid var(--reader-ink);
  color: var(--reader-ink);
  background: transparent;
  height: var(--reader-control-height);
  padding: 0 clamp(18px, 4vw, 28px);
  border-radius: 999px;
  letter-spacing: 0.16em;
  font-weight: 600;
  cursor: pointer;
  transition: background-color var(--reader-transition), color var(--reader-transition), border-color var(--reader-transition), transform 120ms ease;
}
.reader__overlay-btn:active {
  transform: scale(0.98);
}
.reader__overlay-btn:hover {
  background: rgba(255,255,128,0.2);
}
.reader[data-theme='dark'] .reader__overlay-btn:hover {
  background: rgba(0,0,0,0.2);
}
.reader__icon {
  all: unset;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border-radius: 18px;
  border: 1px solid var(--reader-border);
  cursor: pointer;
  transition: background-color var(--reader-transition), border-color var(--reader-transition), color var(--reader-transition);
}
.reader__icon svg { display: block; }
.reader__icon.is-on {
  color: var(--reader-accent);
  border-color: var(--reader-accent);
}
.reader__pill {
  all: unset;
  cursor: pointer;
  font-weight: 700;
  padding: 4px 10px;
  border-radius: 999px;
  background: var(--reader-surface);
  border: 1px solid var(--reader-border);
  color: inherit;
  transition: background-color var(--reader-transition), color var(--reader-transition), border-color var(--reader-transition);
}
.reader__pill.is-active,
.reader__pill--accent {
  background: var(--reader-accent);
  color: var(--reader-black);
  border-color: transparent;
}
.reader__pill:focus-visible {
  outline: 3px solid var(--reader-accent);
  outline-offset: 2px;
}
.reader__stage {
  position: relative;
  flex: 1 1 auto;
  overflow: hidden;
}

.reader__toast {
  position: absolute;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  padding: 8px 16px;
  border-radius: 18px;
  background: var(--reader-surface);
  color: var(--reader-ink);
  border: 1px solid var(--reader-border);
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  font-size: 0.9rem;
  letter-spacing: 0.02em;
}
.reader__tutorial {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: clamp(12px, 5vw, 32px);
  z-index: 50;
  background: radial-gradient(circle at 50% 20%, rgba(0,0,0,0.32), rgba(0,0,0,0.7));
}
.reader__rating {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.6);
  z-index: 120;
  padding: 24px;
}
.reader__rating-card {
  width: min(520px, 92vw);
  border-radius: 28px;
  background: var(--reader-surface);
  border: 1px solid var(--reader-border);
  box-shadow: var(--reader-shadow);
  color: var(--reader-ink);
  padding: clamp(18px, 4vw, 32px);
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.reader__rating-eyebrow {
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.18em;
  font-size: 0.8rem;
  color: var(--reader-muted);
}
.reader__rating-value {
  display: flex;
  align-items: center;
  gap: 16px;
}
.reader__rating-value input {
  flex: 1;
}
.reader__rating-value span {
  font-weight: 800;
}
.reader__rating-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}
.reader__rating-actions button {
  flex: 1 1 calc(50% - 12px);
  border-radius: 999px;
  border: 1px solid var(--reader-border);
  background: transparent;
  padding: 10px 0;
  cursor: pointer;
}
.reader__rating-submit {
  background: var(--reader-accent);
  color: var(--reader-black);
}
.reader__rating-close {
  align-self: flex-end;
  border: none;
  background: transparent;
  color: var(--reader-muted);
  cursor: pointer;
}
.reader__tutorial-card {
  width: min(720px, 95vw);
  border-radius: 28px;
  padding: clamp(18px, 4vw, 32px);
  background: var(--reader-surface);
  border: 1px solid var(--reader-border);
  box-shadow: 0 30px 80px rgba(0,0,0,0.55);
  display: flex;
  flex-direction: column;
  gap: clamp(12px, 3vw, 24px);
  color: var(--reader-ink);
}
.reader__tutorial-eyebrow {
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  font-size: 0.8rem;
  color: var(--reader-muted);
}
.reader__tutorial-title {
  margin: 0;
  font-size: clamp(1.4rem, 3vw, 2rem);
}
.reader__tutorial-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: clamp(12px, 3vw, 24px);
}
.reader__tutorial-grid section {
  background: rgba(0,0,0,0.08);
  border-radius: 16px;
  padding: 12px 16px;
}
.reader[data-theme='light'] .reader__tutorial-grid section {
  background: rgba(0,0,0,0.12);
}
.reader__tutorial-grid h3 {
  margin: 0 0 8px;
  font-size: 0.9rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}
.reader__tutorial-grid ul {
  margin: 0;
  padding-left: 18px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.reader__tutorial-grid li {
  font-size: 0.95rem;
}
.reader__tutorial-grid kbd {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 6px;
  border: 1px solid currentColor;
  font-size: 0.85rem;
}
.reader__tutorial-btn {
  align-self: flex-end;
  border: none;
  border-radius: 999px;
  padding: 10px 22px;
  font-weight: 700;
  background: var(--reader-accent);
  color: var(--reader-black);
  cursor: pointer;
  box-shadow: var(--reader-shadow);
}
.reader__tutorial-btn:focus-visible {
  outline: 3px solid var(--reader-black);
  outline-offset: 2px;
}
.reader__haptics {
  position: absolute;
  bottom: clamp(12px, 4vw, 30px);
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.7);
  color: #fefff4;
  padding: 10px 16px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.2);
  display: inline-flex;
  align-items: center;
  gap: 12px;
}
.reader[data-theme='light'] .reader__haptics {
  background: rgba(254,255,244,0.94);
  color: #424242;
}
.reader__haptics-actions {
  display: inline-flex;
  gap: 8px;
}
.reader__haptics-actions button {
  border: 1px solid var(--reader-border);
  background: transparent;
  padding: 4px 10px;
  border-radius: 10px;
  cursor: pointer;
}
.reader__haptics-actions button:first-child {
  background: var(--reader-accent);
  color: var(--reader-black);
  border-color: transparent;
}
.reader__desktop-hints {
  position: absolute;
  bottom: clamp(20px, 4vw, 48px);
  right: clamp(20px, 4vw, 48px);
  background: rgba(0,0,0,0.55);
  color: #fefff4;
  padding: 14px 18px;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,0.18);
  box-shadow: var(--reader-shadow);
  max-width: 320px;
}
.reader[data-theme='light'] .reader__desktop-hints {
  background: rgba(254,255,244,0.9);
  color: #424242;
}
.reader__desktop-hints h3 {
  margin: 0 0 8px;
  font-size: 0.85rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
}
.reader__desktop-hints ul {
  margin: 0;
  padding-left: 18px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-size: 0.9rem;
}
.desktop-tooltip {
  position: absolute;
  font-size: 0.78rem;
  text-align: center;
  padding: 6px 10px;
  border-radius: 10px;
  background: rgba(0,0,0,0.65);
  color: #fefff4;
  border: 1px solid rgba(255,255,255,0.2);
  pointer-events: none;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}
.reader[data-theme='light'] .desktop-tooltip {
  background: rgba(254,255,244,0.9);
  color: #424242;
  border-color: rgba(0,0,0,0.15);
}
.desktop-tooltip--left {
  left: clamp(12px, 4vw, 40px);
  top: 50%;
  transform: translateY(-50%);
}
.desktop-tooltip--right {
  right: clamp(12px, 4vw, 40px);
  top: 50%;
  transform: translateY(-50%);
}
.desktop-tooltip--top {
  top: clamp(12px, 4vw, 32px);
  left: 50%;
  transform: translateX(-50%);
}
.desktop-tooltip--bottom {
  bottom: clamp(12px, 4vw, 32px);
  left: 50%;
  transform: translateX(-50%);
}
.reader__rating-cta {
  position: absolute;
  bottom: clamp(12px, 4vw, 24px);
  right: clamp(12px, 4vw, 24px);
  border: 1px solid var(--reader-border);
  border-radius: 999px;
  padding: 10px 16px;
  font-weight: 700;
  letter-spacing: 0.08em;
  background: rgba(0,0,0,0.6);
  color: var(--reader-accent);
  cursor: pointer;
}
.reader[data-theme='light'] .reader__rating-cta {
  background: rgba(0,0,0,0.9);
}
.reader__auto {
  border: 1px solid var(--reader-border);
  border-radius: 999px;
  padding: 6px 18px;
  font-weight: 700;
  letter-spacing: 0.08em;
  background: transparent;
  color: inherit;
  cursor: pointer;
  transition: background-color var(--reader-transition), color var(--reader-transition);
}
.reader__auto.is-on {
  background: var(--reader-accent);
  color: var(--reader-black);
}
.reader__auto:focus-visible {
  outline: 3px solid var(--reader-accent);
  outline-offset: 2px;
}
.reader__icon.is-pulse {
  animation: readerPulse 0.4s ease;
}
@keyframes readerPulse {
  0% { transform: scale(0.9); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}
@keyframes dialogueIndicatorPulse {
  0% { opacity: 1; }
  100% { opacity: 0.5; }
}
@keyframes readerBookmarkPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.08); }
  100% { transform: scale(1); }
}

@keyframes readerOverlayEnter {
  0% { opacity: 0; transform: translate3d(0, 12px, 0) scale(0.98); }
  100% { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
}
@keyframes readerOverlayExit {
  0% { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
  100% { opacity: 0; transform: translate3d(0, 10px, 0) scale(0.98); }
}
@keyframes readerPageWipeNext {
  0% { clip-path: inset(0 0 0 100%); opacity: 0.3; }
  100% { clip-path: inset(0); opacity: 1; }
}
@keyframes readerPageWipePrev {
  0% { clip-path: inset(0 100% 0 0); opacity: 0.3; }
  100% { clip-path: inset(0); opacity: 1; }
}

.reader-page {
  position: absolute;
  inset: 0;
  padding: clamp(26px, 6vw, 60px);
  padding-top: calc(clamp(26px, 6vw, 60px) + env(safe-area-inset-top));
  padding-bottom: calc(clamp(26px, 6vw, 60px) + env(safe-area-inset-bottom) + var(--reader-bottom-ui, 0px));
  display: flex;
  align-items: center;
  justify-content: flex-start;
  overflow-y: auto;
  overflow-x: hidden;
  touch-action: none;
  --page-swipe-left: 0%;
  --page-swipe-right: 0%;
  --page-swipe-strength: 0;
  clip-path: inset(0 var(--page-swipe-right) 0 var(--page-swipe-left));
  will-change: clip-path, opacity;
  opacity: calc(1 - (var(--page-swipe-strength) * 0.35));
  transition: clip-path calc(var(--reader-transition) * 0.9), opacity calc(var(--reader-transition) * 0.9);
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.reader-page.page--swiping {
  transition: none;
}
.reader-page::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: linear-gradient(90deg, rgba(0,0,0,0.55) 0%, rgba(0,0,0,0));
  opacity: var(--page-swipe-strength);
  transform-origin: left center;
  transition: opacity 120ms ease;
  mix-blend-mode: multiply;
}
.reader[data-theme='light'] .reader-page::before {
  background: linear-gradient(90deg, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0));
  mix-blend-mode: normal;
}
.reader-page.page--swipe-next::before {
  transform-origin: right center;
  transform: scaleX(-1);
}
.reader-page.page--enter.page--dir-next {
  animation: readerPageWipeNext 320ms cubic-bezier(0.22,0.74,0.35,1) forwards;
}
.reader-page.page--enter.page--dir-prev {
  animation: readerPageWipePrev 320ms cubic-bezier(0.22,0.74,0.35,1) forwards;
}
.reader-page__column {
  width: 100%;
  max-width: min(64ch, var(--reader-page-width));
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  gap: clamp(16px, 3vw, 26px);
}
.para {
  margin: 0;
  font-family: var(--reader-font-family, 'Playfair Display','Libre Baskerville',serif);
  font-weight: var(--reader-font-weight, 400);
  font-size: calc(var(--reader-font-base, 18px) + var(--reader-font-delta, 0px));
  line-height: 1.6;
  letter-spacing: 0;
  text-align: justify;
  text-align-last: left;
  hyphens: none;
  -webkit-hyphens: none;
  word-break: normal;
  overflow-wrap: anywhere;
  text-rendering: optimizeLegibility;
}
.reader__chapter-head {
  text-align: center;
  margin-bottom: clamp(18px, 4vw, 30px);
}
.reader__chapter-title {
  margin: 0;
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  letter-spacing: -0.005em;
  text-transform: uppercase;
  font-size: clamp(28px, 4vw, 36px);
}
.reader__chapter-count {
  margin: 4px 0 0;
  font-family: 'Libre Baskerville','Playfair Display',serif;
  font-size: clamp(14px, 2vw, 16px);
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--reader-muted);
}
.dlg {
  display: grid;
  grid-template-columns: auto 1fr;
  column-gap: 10px;
  row-gap: 2px;
  align-items: center;
  padding: 10px 14px;
  border-radius: 18px;
  position: relative;
  background: transparent;
  transition: background-color var(--reader-transition), color var(--reader-transition), opacity 260ms ease;
  font-size: calc(var(--reader-font-base, 18px) - 1px + var(--reader-font-delta, 0px));
  line-height: 1.6;
}
.dlg__icon {
  color: var(--reader-dialog-indicator-idle);
  transition: color var(--reader-transition), opacity var(--reader-transition);
}
.dlg__bar {
  width: 3px;
  border-radius: 6px;
  background: var(--reader-dialog-indicator-idle);
  align-self: stretch;
  opacity: 0.9;
  transition: background-color var(--reader-transition), opacity var(--reader-transition);
}
.dlg__speaker {
  font-weight: 700;
  letter-spacing: 0.04em;
  text-transform: uppercase;
}
.dlg__text {
  grid-column: span 1;
  letter-spacing: 0;
}
.dlg--read {
  opacity: 0.75;
}
.dlg--read .dlg__bar,
.dlg--read .dlg__icon {
  background: var(--reader-dialog-indicator-read);
  color: var(--reader-dialog-indicator-read);
}
.dlg--active {
  color: var(--reader-dialog-active);
}
.dlg--active .dlg__speaker,
.dlg--active .dlg__text {
  color: var(--reader-dialog-active);
}
.dlg--active .dlg__icon,
.dlg--active .dlg__bar {
  color: var(--reader-dialog-active);
  background: var(--reader-dialog-active);
  animation: dialogueIndicatorPulse 1.2s ease-in-out infinite alternate;
}
.reader__dialog-share {
  position: absolute;
  transform: translate(-50%, -100%);
  background: var(--reader-panel-bg);
  border: 1px solid var(--reader-border);
  border-radius: 16px;
  padding: 10px 14px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.35);
  display: flex;
  flex-direction: column;
  gap: 6px;
  z-index: 30;
  min-width: 190px;
}
.reader__share-btn {
  all: unset;
  padding: 6px 8px;
  border-radius: 999px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 0.75rem;
  text-align: center;
  background: rgba(0,0,0,0.12);
  color: inherit;
  cursor: pointer;
}
.reader[data-theme='dark'] .reader__share-btn {
  background: rgba(255,255,255,0.12);
}
.reader__share-btn.is-disabled {
  opacity: 0.45;
  cursor: default;
  pointer-events: none;
}
.reader__share-btn:focus-visible {
  outline: 2px solid var(--reader-accent);
  outline-offset: 2px;
}
.reader__theme {
  width: 40px;
  height: 40px;
  border-radius: 20px;
  border: 1px solid var(--reader-border);
  background: var(--reader-surface);
  color: inherit;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: background-color var(--reader-transition), border-color var(--reader-transition), color var(--reader-transition);
}
.reader__theme:focus-visible {
  outline: 3px solid var(--reader-accent);
  outline-offset: 3px;
}

.reader__overlay {
  position: fixed;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: max(12px, env(safe-area-inset-top)) max(18px, calc(env(safe-area-inset-right) + 10px)) max(20px, env(safe-area-inset-bottom)) max(18px, calc(env(safe-area-inset-left) + 10px));
  background: transparent;
  opacity: 0;
  pointer-events: none;
  transition: opacity 160ms cubic-bezier(0.4,0,1,1);
  z-index: 20;
}
.reader__theme img {
  width: 20px;
  height: 20px;
  display: block;
}
.reader__overlay[data-phase="enter"] {
  opacity: 1;
  pointer-events: auto;
}
.reader__overlay[data-phase="exit"] {
  opacity: 0;
  pointer-events: none;
}
.reader__overlay-surface {
  width: 100%;
  height: 100%;
  max-height: none;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: var(--reader-overlay-gap);
  padding: clamp(16px, 5vw, 28px) clamp(16px, 6vw, 32px) clamp(18px, 7vw, 36px);
  border-radius: 0;
  background: transparent;
  border: none;
  box-shadow: none;
  transform-origin: top center;
  opacity: 0;
  transform: scale(0.98);
  pointer-events: auto;
  overflow: visible;
}
.reader__overlay[data-phase="enter"] .reader__overlay-surface {
  opacity: 1;
  transform: scale(1);
  transition: transform 220ms cubic-bezier(0,0,0.2,1), opacity 220ms cubic-bezier(0,0,0.2,1);
}
.reader__overlay[data-phase="exit"] .reader__overlay-surface {
  opacity: 0;
  transform: scale(0.98);
  transition: transform 160ms cubic-bezier(0.4,0,1,1), opacity 160ms cubic-bezier(0.4,0,1,1);
}
.reader__overlay-top,
.reader__overlay-bottom {
  display: flex;
  flex-direction: column;
  width: 100%;
  gap: var(--reader-overlay-gap);
}
.reader__overlay-bottom {
  margin-top: auto;
  padding-bottom: clamp(12px, 4vw, 24px);
}
.reader__overlay-topbar {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: clamp(12px, 3vw, 20px);
  flex-wrap: wrap;
}
.reader__overlay-heading {
  font-size: 13px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--reader-muted);
}
.reader__overlay-actions {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.reader__overlay-actions--right {
  margin-left: auto;
  justify-content: flex-end;
}
.reader__overlay-tools {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}
.reader__overlay-close {
  all: unset;
  width: 36px;
  height: 36px;
  border-radius: 18px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.22);
  color: var(--reader-ink);
  cursor: pointer;
  transition: background-color var(--reader-transition);
}
.reader[data-theme='light'] .reader__overlay-close {
  background: rgba(0,0,0,0.18);
}
.reader__overlay-close:focus-visible {
  outline: 3px solid var(--reader-accent);
  outline-offset: 3px;
}

.reader__ui-row {
  opacity: 0;
  clip-path: inset(0 0 100% 0);
}
.reader__ui-row[data-row="0"] { --ui-enter-delay: 120ms; --ui-exit-delay: 0ms; }
.reader__ui-row[data-row="1"] { --ui-enter-delay: 90ms; --ui-exit-delay: 15ms; }
.reader__ui-row[data-row="2"] { --ui-enter-delay: 70ms; --ui-exit-delay: 35ms; }
.reader__ui-row[data-row="3"] { --ui-enter-delay: 50ms; --ui-exit-delay: 65ms; }
.reader__ui-row[data-row="4"] { --ui-enter-delay: 30ms; --ui-exit-delay: 90ms; }
.reader__overlay[data-phase="enter"] .reader__ui-row {
  opacity: 1;
  clip-path: inset(0 0 0 0);
  transition: clip-path 220ms cubic-bezier(0,0,0.2,1), opacity 220ms cubic-bezier(0,0,0.2,1);
  transition-delay: var(--ui-enter-delay, 0ms);
}
.reader__overlay[data-phase="exit"] .reader__ui-row {
  opacity: 0;
  clip-path: inset(0 0 100% 0);
  transition: clip-path 160ms cubic-bezier(0.4,0,1,1), opacity 160ms cubic-bezier(0.4,0,1,1);
  transition-delay: var(--ui-exit-delay, 0ms);
}

.reader__progress {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(env(safe-area-inset-bottom) + clamp(52px, 10vh, 120px));
  width: min(64ch, calc(100% - clamp(40px, 8vw, 80px)));
  height: 2px;
  z-index: 6;
  border-radius: 999px;
  background: rgba(0,0,0,0.2);
  margin: 0;
  overflow: hidden;
  pointer-events: none;
  transition: opacity 180ms ease;
}
.reader[data-theme='dark'] .reader__progress {
  background: rgba(254,255,244,0.2);
}
@media (min-width: 768px) {
  .reader__progress {
    height: 3px;
  }
}
.reader__progress-fill {
  display: block;
  height: 100%;
  background: #FFFF80;
  transition: width 200ms ease, background-color var(--reader-transition);
}

.reader__carousel-shell {
  position: relative;
  margin-top: clamp(16px, 4vw, 28px);
  padding: clamp(18px, 5vw, 28px);
  border-radius: 24px;
  border: 1px solid var(--reader-border);
  overflow: hidden;
  background: var(--reader-carousel-surface, rgba(0,0,0,0.75));
}
.reader[data-theme='light'] .reader__carousel-shell {
  --reader-carousel-surface: #424242;
  color: #fefff4;
}
.reader[data-theme='dark'] .reader__carousel-shell {
  --reader-carousel-surface: #fefff4;
  color: #424242;
}
.reader__carousel-shell.has-prev::before,
.reader__carousel-shell.has-next::after {
  content: '';
  position: absolute;
  top: clamp(10px, 3vw, 24px);
  bottom: clamp(10px, 3vw, 24px);
  width: clamp(30px, 6vw, 48px);
  pointer-events: none;
  z-index: 1;
  transition: opacity 160ms ease;
}
.reader__carousel-shell.has-prev::before {
  left: clamp(18px, 5vw, 32px);
  background: linear-gradient(90deg, rgba(0,0,0,0.35), rgba(0,0,0,0));
}
.reader__carousel-shell.has-next::after {
  right: clamp(18px, 5vw, 32px);
  background: linear-gradient(270deg, rgba(0,0,0,0.35), rgba(0,0,0,0));
}
.reader[data-theme='dark'] .reader__carousel-shell.has-prev::before {
  background: linear-gradient(90deg, rgba(66,66,66,0.15), rgba(66,66,66,0));
}
.reader[data-theme='dark'] .reader__carousel-shell.has-next::after {
  background: linear-gradient(270deg, rgba(66,66,66,0.15), rgba(66,66,66,0));
}
.reader__carousel {
  display: flex;
  gap: 16px;
  overflow-x: auto;
  padding: 8px 4px;
  scroll-snap-type: x mandatory;
  scroll-padding-inline: clamp(8px, 3vw, 24px);
  -webkit-overflow-scrolling: touch;
}
.reader__carousel::-webkit-scrollbar {
  display: none;
}
.reader__carousel-nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 42px;
  height: 42px;
  border-radius: 21px;
  border: none;
  background: rgba(0,0,0,0.35);
  color: #fefff4;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  opacity: 0;
  pointer-events: none;
  transition: opacity 160ms ease;
  z-index: 2;
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
}
.reader[data-theme='dark'] .reader__carousel-nav {
  background: rgba(254,255,244,0.85);
  color: #424242;
}
.reader__carousel-shell.has-prev .reader__carousel-nav--prev,
.reader__carousel-shell.has-next .reader__carousel-nav--next {
  opacity: 1;
  pointer-events: auto;
}
.reader__carousel-nav--prev {
  left: clamp(18px, 5vw, 32px);
}
.reader__carousel-nav--next {
  right: clamp(18px, 5vw, 32px);
}
.reader__carousel-nav:focus-visible {
  outline: 2px solid var(--reader-accent);
  outline-offset: 2px;
}
.reader__carousel-nav:disabled {
  opacity: 0;
  pointer-events: none;
}
.reader__thumb {
  flex: 0 0 calc((100% - 16px) / 2);
  min-width: calc((100% - 16px) / 2);
  border: none;
  background: rgba(0,0,0,0.18);
  color: inherit;
  border-radius: 16px;
  overflow: hidden;
  position: relative;
  scroll-snap-align: center;
  display: flex;
  flex-direction: column;
  cursor: pointer;
  transition: transform 160ms ease, background-color var(--reader-transition);
}
.reader[data-theme='dark'] .reader__thumb {
  background: rgba(0,0,0,0.04);
}
.reader__thumb:focus-visible {
  outline: 3px solid var(--reader-accent);
  outline-offset: 2px;
}
.reader__thumb:active {
  transform: translateY(2px);
}
.reader__thumb-img {
  position: relative;
  width: 100%;
  padding-top: 56.25%;
  background: linear-gradient(135deg, rgba(0,0,0,0.35), rgba(0,0,0,0.08));
  border-radius: 16px 16px 0 0;
}
.reader[data-theme='dark'] .reader__thumb-img {
  background: linear-gradient(135deg, rgba(66,66,66,0.15), rgba(0,0,0,0.04));
}
.reader__thumb-badge {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  min-width: 36px;
  padding: 4px 10px;
  border-radius: 999px;
  font-family: 'Libre Baskerville','Playfair Display',serif;
  font-size: 0.8rem;
  font-weight: 700;
  background: #fefff4;
  color: #424242;
  border: 1px solid rgba(0,0,0,0.3);
  letter-spacing: 0.06em;
}
.reader[data-theme='dark'] .reader__thumb-badge {
  background: #424242;
  color: #fefff4;
  border-color: transparent;
}
.reader__thumb-body {
  padding: 14px 16px 18px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.reader__thumb-title {
  margin: 0;
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  font-size: 1rem;
}
.reader__thumb-snippet {
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.4;
  opacity: 0.85;
}
.reader__carousel-empty {
  width: 100%;
  text-align: center;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  padding: clamp(24px, 6vw, 40px);
}

.reader__potards {
  display: flex;
  justify-content: center;
  gap: clamp(32px, 7vw, 60px);
  padding: clamp(14px, 6vw, 28px);
  flex-wrap: wrap;
}
.reader__overlay-controls {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  gap: clamp(12px, 4vw, 24px);
}
.reader__overlay-controls-left,
.reader__overlay-controls-right {
  display: inline-flex;
  align-items: center;
  gap: clamp(10px, 3vw, 18px);
  flex-wrap: wrap;
  flex: 1 1 min(340px, 48%);
}
.reader__overlay-controls-right {
  margin-left: 0;
  justify-content: flex-end;
}
.reader__overlay-controls-left {
  justify-content: flex-start;
}
.reader__potard-cell {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  color: var(--reader-potard-text);
  text-align: center;
  user-select: none;
}
.reader__potard-name {
  text-transform: uppercase;
  letter-spacing: 0.16em;
  font-size: 0.7rem;
  font-weight: 700;
  opacity: 0.85;
}
.reader__potard-value {
  font-weight: 700;
  letter-spacing: 0.1em;
  font-size: 0.85rem;
}
.reader__potard {
  width: var(--reader-control-height);
  height: var(--reader-control-height);
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: ns-resize;
  touch-action: none;
}
.reader__potard svg {
  width: 100%;
  height: 100%;
  display: block;
}
.reader__potard-track,
.reader__potard-arc {
  fill: none;
}
.reader__potard-track {
  stroke: var(--reader-potard-track);
}
.reader__potard-arc {
  stroke: #ffff80;
  stroke-linecap: round;
}
.reader__potard-toggle {
  position: absolute;
  width: 22px;
  height: 22px;
  border-radius: 11px;
  border: none;
  background: rgba(0,0,0,0.75);
  color: #ffff80;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.reader[data-theme='dark'] .reader__potard-toggle {
  background: rgba(254,255,244,0.9);
  color: #000000;
}
.reader__potard-toggle:focus-visible {
  outline: 2px solid var(--reader-accent);
  outline-offset: 2px;
}

@media (min-width: 900px) {
  .reader__carousel {
    gap: 20px;
  }
  .reader__thumb {
    flex: 0 0 calc((100% - 40px) / 3);
    min-width: calc((100% - 40px) / 3);
  }
}

.reader__dock {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: clamp(8px, 3vw, 18px);
  padding: clamp(14px, 4vw, 24px) clamp(12px, 6vw, 28px);
  flex-wrap: wrap;
  margin-top: auto;
}
.reader__dock-pill,
.reader__dock-circle {
  border: none;
  cursor: pointer;
  transition: background-color var(--reader-transition), color var(--reader-transition), transform 120ms ease;
}
.reader__dock-pill {
  min-width: clamp(120px, 22vw, 200px);
  padding: 0 clamp(18px, 5vw, 30px);
  height: var(--reader-control-height);
  border-radius: 999px;
  background: var(--reader-dock-pill-bg);
  color: var(--reader-dock-pill-fg);
  letter-spacing: 0.18em;
  font-weight: 700;
  font-size: 0.82rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-transform: uppercase;
}
.reader__dock-pill--icon {
  min-width: auto;
  width: auto;
  padding: 0 clamp(20px, 4vw, 30px);
}
.reader__dock-pill--icon img {
  width: clamp(22px, 5vw, 34px);
  height: auto;
  display: block;
}
.reader__dock-pill.is-active {
  background: var(--reader-dock-pill-active-bg);
  color: var(--reader-dock-pill-active-fg);
}
.reader__dock-pill:not(.is-disabled):focus-visible {
  background: var(--reader-dock-pill-active-bg);
  color: var(--reader-dock-pill-active-fg);
}
.reader__dock-pill:not(.is-disabled):active {
  background: var(--reader-dock-pill-active-bg);
  color: var(--reader-dock-pill-active-fg);
}
.reader__dock-circle {
  width: var(--reader-control-height);
  height: var(--reader-control-height);
  border-radius: 999px;
  background: var(--reader-dock-circle-bg);
  color: var(--reader-dock-circle-fg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-family: 'Libre Baskerville','Playfair Display',serif;
  font-weight: 700;
  font-size: 1.05rem;
  letter-spacing: 0.04em;
}
.reader__dock-circle--next {
  font-size: 1.08rem;
}
.reader__dock-circle.is-star {
  width: calc(var(--reader-control-height) + 4px);
  height: calc(var(--reader-control-height) + 4px);
}
.reader__dock-star {
  width: 22px;
  height: 22px;
  display: block;
  color: var(--reader-accent);
}
.reader[data-theme='dark'] .reader__dock-star {
  color: #000000;
}
.reader__dock-pill.is-disabled,
.reader__dock-circle.is-disabled {
  opacity: 0.4;
  cursor: default;
  pointer-events: none;
}
.reader__dock-circle span {
  display: inline-block;
  line-height: 1;
}
.reader__dock-circle:not(.is-disabled):focus-visible {
  background: var(--reader-dock-circle-active-bg);
  color: var(--reader-dock-circle-active-fg);
}
.reader__dock-circle:not(.is-disabled):active {
  background: var(--reader-dock-circle-active-bg);
  color: var(--reader-dock-circle-active-fg);
}
.reader__dock-pill:active,
.reader__dock-circle:active {
  transform: scale(0.97);
}

.reader__panel {
  margin-top: 8px;
  padding: 16px;
  border-radius: 20px;
  background: var(--reader-panel-bg);
  border: 1px solid var(--reader-border);
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.reader__panel-title {
  font-weight: 700;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: var(--reader-muted);
}
.reader__panel-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(44px, 1fr));
  gap: 8px;
}
.reader__cell {
  all: unset;
  display: grid;
  place-items: center;
  height: 44px;
  border-radius: 12px;
  background: rgba(0,0,0,0.24);
  color: inherit;
  font-weight: 600;
  cursor: pointer;
  transition: background-color var(--reader-transition), color var(--reader-transition);
}
.reader[data-theme='light'] .reader__cell {
  background: rgba(66,66,66,0.12);
}
.reader__cell.is-current {
  background: var(--reader-accent);
  color: var(--reader-black);
}
.reader__panel-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: space-between;
}

@media (max-width: 768px) {
  .reader__thumb {
    flex: 0 0 calc(50% - 14px);
  }
}
@media (max-width: 540px) {
  .reader__thumb {
    flex: 0 0 calc(100% - 10px);
  }
}

@media (max-width: 768px) {
  .reader__overlay {
    align-items: flex-end;
    padding: clamp(12px, 6vw, 28px);
  }
  .reader__overlay-surface {
    width: 100%;
    margin: 0;
    max-height: calc(100% - clamp(24px, 12vw, 80px));
    border-radius: 24px 24px 18px 18px;
  }
  .reader__overlay-topbar {
    flex-direction: column;
    align-items: flex-start;
  }
  .reader__overlay-actions {
    margin-left: 0;
  }
  .reader__overlay-rails {
    justify-content: center;
  }
  .reader__dock {
    flex-wrap: wrap;
    justify-content: center;
  }
}

@media (prefers-reduced-motion: reduce) {
  .reader {
    --reader-transition: 1ms linear;
  }
  .reader-page {
    transition: none;
    animation: none !important;
    clip-path: inset(0);
    opacity: 1;
  }
}

.reader__audio-prompt {
  position: absolute;
  left: 50%;
  top: 12px;
  transform: translateX(-50%);
  background: var(--reader-surface);
  color: inherit;
  padding: 10px 14px;
  border-radius: 12px;
  border: 1px solid var(--reader-border);
  box-shadow: var(--reader-shadow);
  z-index: 10060;
  font-weight: 700;
  letter-spacing: 0.02em;
  cursor: pointer;
}
.reader__audio-prompt:focus-visible {
  outline: 3px solid var(--reader-accent);
  outline-offset: 2px;
}
.reader__paywall {
  background: var(--reader-panel-bg);
  border: 1px solid var(--reader-border);
  border-radius: 28px;
  padding: clamp(24px, 5vw, 40px);
  box-shadow: var(--reader-shadow);
  text-align: center;
  color: var(--reader-ink);
  width: min(420px, 90vw);
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.reader__paywall-eyebrow {
  text-transform: uppercase;
  letter-spacing: 0.18em;
  font-size: 0.8rem;
  color: var(--reader-muted);
  margin: 0;
}
.reader__paywall h2 {
  margin: 0;
  font-size: clamp(1.6rem, 4vw, 2.1rem);
}
.reader__paywall-lede {
  margin: 0;
  color: var(--reader-muted);
}
.reader__paywall-note {
  margin: 0;
  font-size: 0.9rem;
  color: var(--reader-muted);
}
.reader__paywall-share-block {
  margin-top: 8px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.reader__paywall-paypal {
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 14px;
  padding: 10px 16px;
  background: #ffc439;
  color: #1f2023;
  font-weight: 700;
  cursor: pointer;
}
.reader__paywall-share {
  border: none;
  border-radius: 18px;
  padding: 10px 16px;
  font-weight: 700;
  letter-spacing: 0.08em;
  background: rgba(0,0,0,0.75);
  color: var(--reader-accent);
  cursor: pointer;
  transition: transform 160ms ease, opacity 160ms ease;
}
.reader[data-theme='light'] .reader__paywall-share {
  background: rgba(0,0,0,0.9);
  color: var(--reader-accent);
}
.reader__paywall-share:hover {
  transform: translateY(-1px);
}
.reader__paywall-secondary {
  border: 1px solid var(--reader-border);
  background: transparent;
  color: inherit;
  border-radius: 999px;
  padding: 8px 16px;
  cursor: pointer;
}
.reader__paywall-secondary:focus-visible {
  outline: 3px solid var(--reader-accent);
  outline-offset: 2px;
}

/* Skeleton states for loading tales */
.card--skeleton .card__media { background: #3b3b3b !important; filter: saturate(0.6) brightness(0.9); }
.card--skeleton .card__overlay { opacity: 0.4; }
.card--skeleton .card__label { color: transparent !important; background: linear-gradient(90deg, rgba(255,255,255,0.08), rgba(255,255,255,0.18), rgba(255,255,255,0.08)); background-size: 200% 100%; animation: shimmer 1.2s ease-in-out infinite; border-radius: 6px; min-height: 1.8rem; }
.card--skeleton .card__badge { background: #666 !important; color: transparent !important; box-shadow: none !important; border: none !important; }
@keyframes shimmer { 0% { background-position: 0% 0; } 100% { background-position: 200% 0; } }

/* Extra-wide screens: 4 columns gallery */
@media (min-width: 1536px) {
  .gallery { grid-template-columns: repeat(4, minmax(0, 1fr)); width: min(1480px, 90vw); }
}

/* =============================
   Gate Centering Overrides (final)
   Ensure strict horizontal centering on all devices
   ============================= */
.gate__hit { transform: none !important; }
.gate__msg {
  position: static !important;
  left: auto !important; top: auto !important; transform: none !important;
  margin-left: auto !important; margin-right: auto !important;
  text-align: center !important;
  max-width: min(90vw, 640px) !important;
}
.gate__logo {
  position: static !important;
  left: auto !important; top: auto !important; transform: none !important;
  display: block !important;
  margin-left: auto !important; margin-right: auto !important;
  transform-origin: 50% 50% !important;
  width: clamp(140px, min(52vw, 36vh), 360px) !important;
  max-width: min(380px, calc(100vw - 48px)) !important;
  max-height: min(44vh, 44dvh) !important;
}
.gate.is-starting .gate__msg { transform: none !important; }
.gate.is-finishing .gate__logo { transform: scale(1.03) !important; }

/* Re-declare keyframes to remove any residual translate from earlier blocks */
@keyframes gate-zoom {
  0% { transform: scale(0.98); }
  100% { transform: scale(1.02); }
}
/* Replace dialogue icon text with inline SVG via background */
.dlg__icon { 
  display: inline-block; width: 18px; height: 18px; vertical-align: -2px; 
  background: no-repeat center/contain url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='%23fefff4' d='M12 3a9 9 0 100 18 9 9 0 000-18zm1 13h-2v-2h2v2zm0-4h-2V6h2v6z'/></svg>");
  /* hide any fallback text like '??' */
  font-size: 0; color: transparent; overflow: hidden;
}





.reader__header-actions {
  display: flex;
  flex-direction: column;
  gap: 8px;
  align-items: flex-end;
}
.reader__text-stack {
  display: flex;
  flex-direction: column;
  gap: clamp(10px, 2vw, 14px);
  align-items: flex-end;
}
.reader__text-row {
  display: flex;
  align-items: center;
  gap: clamp(10px, 2vw, 16px);
}

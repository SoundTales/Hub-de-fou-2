@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Libre+Baskerville:wght@400;700&display=swap');

/* Base */
:root { font-family: 'Playfair Display', serif; color: #1f2023; background-color: #424242; 
  --cta-bg: #ffff80; /* main yellow */
  --cta-sep-bg: #fefde8; /* pale wedge near bookmark */
  --ink: #000000;
  --cta-tip: 22px; /* triangular tip width for CTA */
  /* How far the hero image bleeds under the gallery for a smoother transition */
  --hero-bleed: 220px;
}
/* Pseudo fullscreen: use computed inner height when Fullscreen API is blocked */
html.pseudo-fullscreen, body.pseudo-fullscreen { 
  height: var(--inner-h, 100dvh);
  min-height: var(--inner-h, 100dvh);
}
.pseudo-fullscreen .page { 
  min-height: var(--inner-h, 100dvh);
}
* { box-sizing: border-box; }
body { margin: 0; min-height: 100vh; background: #424242; color: #f5f5f5; }

/* Hide scrollbars everywhere while preserving scroll */
html, body { -ms-overflow-style: none; scrollbar-width: none; }
* { scrollbar-width: none; }
*::-webkit-scrollbar { width: 0 !important; height: 0 !important; }

/* Allow scrolling in fullscreen on desktop (remove forced overflow hidden) */

/* Page structure */
.page { position: relative; background: #424242; color: #f5f5f5; min-height: 100vh; padding: 0 0 80px; display: flex; flex-direction: column; width: 100%; }

/* Safe-area padding for notches */
.page {
  padding-left: max(0px, env(safe-area-inset-left));
  padding-right: max(0px, env(safe-area-inset-right));
}

/* Hero */
.hero {
  position: relative !important;
  top: auto !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  height: 50vh !important;
  min-height: 0 !important;
  background: none !important; /* image moved to ::before to allow transparency mask */
  margin-bottom: clamp(24px, 4vw, 56px) !important;
}

/* Background image with bottom transparency mask */
.hero::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: calc(var(--hero-bleed) * -1);
  /* Ensure the visible portion is always the center of the image
     even when the pseudo-element extends below the hero. We offset
     the vertical background position upward by half of the bleed. */
  background-image: url('https://static.wixstatic.com/media/b9ad46_c71b6b5da4f54f7583853c3744a28a79~mv2.webp');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center calc(50% - (var(--hero-bleed) / 2));
  z-index: 1;              /* below .hero__fade (2) and content (3) */
  pointer-events: none;
  /* Even more progressive fade into the page background */
  -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,1) 58%, rgba(0,0,0,0) 100%);
  mask-image: linear-gradient(to bottom, rgba(0,0,0,1) 58%, rgba(0,0,0,0) 100%);
  /* optional: smoother GPU hint */
  will-change: mask-image;
}

/* Fade overlay (deduped) */
.hero__fade {
  position: absolute;
  top: 0; left: 0; right: 0; bottom: calc(var(--hero-bleed) * -1);
  pointer-events: none;
  opacity: 1;
  z-index: 2 !important;
  /* Modern bottom blend into the page background (softer, longer) */
  background: linear-gradient(
    to bottom,
    rgba(66,66,66,0) 0%,
    rgba(66,66,66,0.08) 40%,
    rgba(66,66,66,0.20) 60%,
    rgba(66,66,66,0.35) 75%,
    rgba(66,66,66,0.60) 88%,
    #424242 100%
  ) !important;
}
.hero__content { position: relative !important; z-index: 3 !important; }

/* Content */
.hero__content {
  margin: 0 auto !important;
  width: min(92vw, 720px) !important;
  padding: clamp(24px, 5vw, 56px) 24px !important;
  display: flex !important; flex-direction: column !important; align-items: center !important; justify-content: center !important;
  text-align: center !important; gap: clamp(10px, 2.5vw, 22px) !important;
}

/* Title + eyebrow */
.hero__title {
  font-family: 'Playfair Display', serif;
  /* lock size behavior across devices using viewport scaling */
  font-size: clamp(64px, 10vw, 140px) !important;
  letter-spacing: 0.12em !important; text-transform: uppercase; line-height: 1.08;
  margin: 0 !important; max-width: 100%;
  /* Keep title on one line and prevent mid-word breaks */
  white-space: nowrap; word-break: normal; overflow-wrap: normal; hyphens: manual;
  text-shadow: 0 14px 32px rgba(0,0,0,0.35);
  color: #fefff4 !important; /* OSRASE */
}
.hero__eyebrow { white-space: nowrap;  font-size: clamp(0.9rem, 2vw, 1.2rem); letter-spacing: 0.24em; font-weight: 600; line-height: 1.2; }
.hero__content .hero__eyebrow { white-space: nowrap;  margin-bottom: 0; line-height: 1.05; }
.hero__eyebrow + .hero__title { margin-top: calc(-1 * clamp(12px, 3vw, 24px)); }
.hero__eyebrow-primary { color: #ffff80 !important; }   /* SOUND TALES */
.hero__eyebrow-secondary { color: #fefff4 !important; } /* PRODUCTION */
/* Subtle depth for eyebrow text */
.hero__eyebrow,
.hero__eyebrow * { text-shadow: 0 1px 0 rgba(0,0,0,0.16), 0 8px 18px rgba(0,0,0,0.25); }

/* Eyebrow (SOUND TALES PRODUCTION) — force Playfair Display */
.hero__eyebrow,
.hero__eyebrow * {
  font-family: 'Playfair Display', serif !important;
}

/* Meta badges */
.hero__meta {
  display: flex; align-items: center; flex-wrap: wrap;
  gap: clamp(8px, 2vw, 16px); margin-top: clamp(4px, 1vw, 12px);
}
.hero__tag {
  display: inline-flex; align-items: center; white-space: nowrap;
  padding: 8px 14px; font-size: 0.85rem; font-weight: 700; letter-spacing: 0.06em;
  color: #fefff4 !important; background: #424242 !important; border: 1px solid #424242 !important;
  border-radius: 10px; box-shadow: 0 1px 2px rgba(0,0,0,0.22), 0 8px 18px rgba(0,0,0,0.28);
}
.hero__tag.hero__tag--age {
  font-family: 'Libre Baskerville','Baskerville',serif !important;
  font-size: 0.82rem !important;
}

/* Actions */
.hero__actions { display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 28px; }
.hero__cta {
  position: relative !important;
  display: inline-flex !important; align-items: center !important; justify-content: center !important;
  height: 52px !important; padding: 0 62px !important;
  background: var(--cta-bg) !important; color: var(--ink) !important; border: none !important; 
  /* Arrondir les côtés du bouton (style capsule) */
  border-radius: 26px !important;
  font-size: 1.05rem !important; font-weight: 800 !important; letter-spacing: 0.05em !important; text-transform: uppercase !important;
  /* Supprimer l’ancienne forme hexagonale */
  -webkit-clip-path: none !important;
          clip-path: none !important;
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.04);
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
  will-change: transform;
}
/* highlight layer */
.hero__cta::after { content: ''; position: absolute; inset: 0; border-radius: inherit; pointer-events: none; background: linear-gradient(to bottom, rgba(255,255,255,0.22), rgba(255,255,255,0) 42%); mix-blend-mode: soft-light; }
/* Remove pseudo-elements to ensure single-shape CTA */

/* Wedge removed intentionally to avoid extra shape between buttons */
.hero__bookmark {
  position: relative !important;
  height: 52px !important; width: 52px !important; padding: 0 !important;
  display: flex !important; align-items: center !important; justify-content: center !important;
  background: var(--cta-sep-bg) !important; border: none !important; border-radius: 8px !important;
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.04);
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
  will-change: transform;
}
.hero__bookmark-icon { width: 20px !important; height: 20px !important; color: #424242 !important; fill: #424242 !important; }
/* highlight layer */
.hero__bookmark::after { content: ''; position: absolute; inset: 0; border-radius: inherit; pointer-events: none; background: linear-gradient(to bottom, rgba(255,255,255,0.18), rgba(255,255,255,0) 45%); mix-blend-mode: soft-light; }

/* Compact state */
.page--scrolled .hero { height: 45vh !important; min-height: 260px !important; }
.page--scrolled .hero__content {
  position: absolute !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important;
  max-width: min(96vw, 640px) !important; gap: clamp(12px, 3vw, 24px) !important; padding: clamp(24px, 5vw, 48px) 24px !important;
}
.page--scrolled .hero__title { font-size: clamp(1.3rem, 2.3vw, 1.6rem) !important; margin: 0 !important; }
.page--scrolled .hero__cta { height: 52px !important; padding: 0 62px !important; font-size: 1.05rem !important; letter-spacing: 0.05em !important; }
.page--scrolled .hero__bookmark { width: 52px !important; height: 52px !important; }
.page--scrolled .hero__bookmark-icon { width: 20px !important; height: 20px !important; }

/* Cards + gallery */
.card {
  background: #424242; border-radius: 28px; padding: 24px 26px 32px;
  /* Ombres modernisées (plus douces, multi-couches) */
  box-shadow:
    0 1px 2px rgba(0,0,0,0.35),
    0 8px 18px rgba(0,0,0,0.35),
    0 0 0 1px rgba(255,255,128,0.08);
  display: flex; flex-direction: column; gap: 20px; color: #f5f5f5; cursor: pointer;
  transition: transform 220ms ease, box-shadow 220ms ease, filter 220ms ease;
}
.card:hover { 
  transform: translateY(-4px) scale(1.01);
  box-shadow:
    0 4px 10px rgba(0,0,0,0.35),
    0 16px 36px rgba(0,0,0,0.45),
    0 0 0 1px rgba(255,255,128,0.16);
}
/* Card title: support up to ~40 characters gracefully (2 lines max) */
.card__label {
  color: #fefff4; font-family: 'Playfair Display', serif; text-align: center;
  font-size: 1.5rem; letter-spacing: 0.02em; line-height: 1.25; margin: 0 auto;
  max-width: 92%;
  display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; line-clamp: 2;
  overflow: hidden; text-overflow: ellipsis; word-break: break-word;
  /* reserve space to avoid layout shift when clamped */
  min-height: calc(1.25em * 2);
  text-wrap: balance;
}
/* Modernize the inner elements inside cards (labels, image, badge) */
.card__label {
  font-weight: 600;
  letter-spacing: 0.02em;
  text-shadow: 0 1px 1px rgba(0,0,0,0.5);
}
.card__media { position: relative; border-radius: 22px; overflow: visible; aspect-ratio: 16/9; width: 100%; flex: 1 0 auto; background-size: cover; background-position: center; background-repeat: no-repeat; margin-top: 34px; transition: transform 220ms ease; will-change: transform; }
.card__media::before, .card__media::after, .card__badge::before, .card__badge::after { content: none !important; display: none !important; } /* dedupe */
.card__overlay { position: absolute; inset: 0; background: linear-gradient(180deg, rgba(6,8,15,0.05) 0%, rgba(6,8,15,0.65) 100%); pointer-events: none; transition: opacity 220ms ease; }
.card:hover .card__media { transform: scale(1.02); }
.card:hover .card__overlay { opacity: 0.96; }
.card__badge {
  width: 72px; height: 72px; border-radius: 50%;
  background: #fefff4; color: #1f2023; font-weight: 700; font-size: 1.7rem;
  display: grid; place-items: center;
  border: 2px solid rgba(0,0,0,0.22);
  box-shadow: 0 6px 16px rgba(0,0,0,0.45), 0 0 0 3px rgba(254,255,244,0.7) inset;
  position: absolute; top: 0; left: 50%; transform: translate(-50%, -50%); z-index: 2;
  font-family: 'Libre Baskerville','Baskerville','Playfair Display',serif;
}
.card:hover .card__badge { box-shadow: 0 10px 22px rgba(0,0,0,0.5), 0 0 0 3px rgba(254,255,244,0.85) inset; }

/* Gallery (base: desktop/tablette paysage → 3 colonnes, cartes plus grandes)
   Place gallery above the extended hero fade */
.gallery { position: relative; z-index: 10 !important; width: min(1220px, 94vw); margin: 0 auto; display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 34px; }
.gallery .card { padding: 22px 26px 28px; gap: 18px; }
.gallery .card__label { margin-top: 6px; font-size: 1.6rem; }
.gallery .card__media { margin-top: 28px; }
.gallery .card__badge { width: 50px; height: 50px; font-size: 1.24rem; border-width: 1.5px; }

/* Media queries (single set) */
@media (min-width: 1400px) {
  .gallery { width: min(1320px, 92vw); gap: 36px; }
  .gallery .card { padding: 28px 32px 36px; gap: 20px; }
  .gallery .card__media { margin-top: 32px; }
}

@media (max-width: 900px) {
  .hero__content {
    padding: clamp(24px, 5vw, 48px);
    max-width: 96vw;
    gap: clamp(10px, 2vw, 18px);
    align-items: center;
    text-align: center;
  }
}

@media (max-width: 768px) {
  .hero { padding: 32px 16px; }
  .hero__content { padding: 32px 20px; gap: 16px; }
  .hero__title { font-size: clamp(2.8rem, 10vw, 4rem); text-align: center; }
  /* Tablet portrait → 2 colonnes pour agrandir les cartes */
  .gallery { width: min(980px, 94vw); grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 28px; }
}

@media (max-width: 480px) {
  .hero { padding: 24px 16px; height: 62vh !important; }
  .hero__content { padding: 28px 16px; gap: 14px; }
  .hero__title { font-size: clamp(56px, 18vw, 96px) !important; }
  .hero__meta { gap: 8px; }
  .hero__tag { padding: 6px 14px; font-size: 0.8rem; }
  /* Keep hero buttons identical on small screens */
  .hero__actions { gap: 10px; margin-top: 22px; flex-wrap: nowrap; }
  .hero__cta { height: 56px !important; padding: 0 48px !important; min-width: clamp(240px, 74vw, 520px); font-size: 1.05rem !important; }
  .hero__bookmark { width: 56px !important; height: 56px !important; }
  /* Mobile → 1 colonne, cartes larges */
  .gallery { width: 94vw; gap: 32px; margin-top: 36px; grid-template-columns: 1fr; }
}

/* Force consistent centered layout across all devices */
.hero { justify-content: center !important; }
.hero__content {
  align-items: center !important;
  text-align: center !important;
  margin-left: auto !important;
  margin-right: auto !important;
  width: min(92vw, 720px) !important;
  left: auto !important; transform: none !important;
}

/* Keep same layout even for page--scrolled state */
.page--scrolled .hero { height: 50vh !important; }
.page--scrolled .hero__content {
  position: relative !important; top: auto !important; left: auto !important; transform: none !important;
  align-items: center !important; text-align: center !important; margin: 0 auto !important;
}

/* Skip link (visible on focus) */
.skip-link {
  position: absolute;
  top: 8px;
  left: 8px;
  z-index: 1000;
  padding: 10px 14px;
  background: #ffff80;
  color: #000;
  border-radius: 10px;
  text-decoration: none;
  transform: translateY(-120%);
  transition: transform 0.2s ease;
}
.skip-link:focus,
.skip-link:focus-visible {
  transform: translateY(0);
  outline: 3px solid #000;
  outline-offset: 2px;
}

/* Focus-visible outlines for interactive elements */
.hero__cta:focus-visible,
.hero__bookmark:focus-visible,
.card:focus-visible {
  outline: 3px solid #ffff80;
  outline-offset: 3px;
  border-radius: 12px;
}

/* Subtle hover/active feedback */
.hero__cta,
.hero__bookmark {
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
}
.hero__cta:hover,
.hero__bookmark:hover {
  transform: translateY(-2px);
  box-shadow: 0 3px 8px rgba(0,0,0,0.22), 0 14px 28px rgba(0,0,0,0.32), 0 0 0 1px rgba(0,0,0,0.06);
}
.hero__cta:active,
.hero__bookmark:active {
  transform: translateY(0);
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.05);
}
@media (hover: none) {
  .card:hover .card__media { transform: none; }
  .card:hover .card__overlay { opacity: 1; }
  .hero__cta:hover,
  .hero__bookmark:hover { transform: none; box-shadow: none; }
}

/* Visual state when bookmarked */
.hero__bookmark.is-bookmarked,
.hero__bookmark[aria-pressed="true"] {
  background: #ffff80 !important;
  color: #000 !important;
}
.hero__bookmark.is-bookmarked .hero__bookmark-icon,
.hero__bookmark[aria-pressed="true"] .hero__bookmark-icon {
  color: #000 !important;
  fill: #000 !important;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  * {
    animation: none !important;
    transition-duration: 0.01ms !important;
    transition-delay: 0ms !important;
  }
  .card:hover,
  .hero__cta:hover,
  .hero__bookmark:hover {
    transform: none !important;
    box-shadow: none !important;
  }
}
/* Tablet portrait adjustments (600px-1024px, portrait) */
@media (min-width: 600px) and (max-width: 1024px) and (orientation: portrait) {
  .hero { height: 50vh !important; }
  .hero__content { width: min(88vw, 760px) !important; gap: 18px; }
  .hero__title { font-size: clamp(72px, 10vw, 110px) !important; }
  .hero__actions { gap: 10px; }
  .hero__cta { height: 56px !important; padding: 0 72px !important; min-width: clamp(260px, 42vw, 420px); }
  .hero__bookmark { width: 56px !important; height: 56px !important; }
  /* Tablet portrait → 2 colonnes pour cartes plus grandes */
  .gallery { width: min(980px, 94vw); grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 28px; }
  .gallery .card { padding: 22px 26px 28px; }
}

@media (min-width: 768px) and (orientation: landscape) {
  .hero { height: 50vh !important; justify-content: flex-start !important; }
  .hero__content {
    align-items: flex-start !important;
    text-align: left !important;
    margin-left: clamp(48px, 8vw, 120px) !important;
    margin-right: auto !important;
    width: min(560px, 46vw) !important;
    margin-top: clamp(20px, 6vh, 72px) !important;
  }
  .hero__title { font-size: clamp(64px, 8.5vw, 110px) !important; }
  .hero__actions { justify-content: flex-start; gap: 8px; margin-top: 18px; }
  .hero__cta { height: 52px !important; padding: 0 60px !important; }
  .hero__bookmark { width: 52px !important; height: 52px !important; }
  /* Tablette paysage / Desktop par défaut → 3 colonnes, plus grands */
  .gallery { width: min(1220px, 94vw); grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 34px; }
}

/* Desktop (>= 1025px) */
@media (min-width: 1025px) {
  .hero { height: 48vh !important; justify-content: flex-start !important; }
  .hero__content {
    align-items: flex-start !important;
    text-align: left !important;
    margin-left: clamp(60px, 8vw, 140px) !important;
    margin-right: auto !important;
    width: min(600px, 44vw) !important;
  }
  .hero__title { font-size: clamp(72px, 7.8vw, 120px) !important; }
  .hero__actions { justify-content: flex-start; gap: 8px; margin-top: 20px; }
  .hero__cta { height: 52px !important; padding: 0 64px !important; }
  .hero__bookmark { width: 52px !important; height: 52px !important; }
  .gallery { width: min(1320px, 92vw); grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 36px; }
}

/* Floating actions bar (appears when hero actions are off-screen) */
.fab {
  position: fixed !important;
  left: 50%; bottom: max(16px, env(safe-area-inset-bottom));
  transform: translateX(-50%);
  display: flex; gap: 10px; align-items: center; flex-wrap: nowrap; justify-content: center;
  padding: 0; /* no surrounding background */
  background: transparent;
  box-shadow: none;
  border-radius: 0;
  z-index: 10000;
  /* smooth appear */
  opacity: 0;
  animation: fab-fade-in 360ms ease-out forwards;
  /* Improve reliability of fixed on mobile/WebViews */
  will-change: transform;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  pointer-events: auto;
  /* Keep inside viewport width and avoid overflow */
  max-width: calc(100vw - 32px - env(safe-area-inset-left) - env(safe-area-inset-right));
  width: max-content;
  min-width: 0;
}
.fab .hero__cta { height: 48px !important; padding: 0 28px !important; white-space: nowrap; }
.fab .hero__bookmark { width: 48px !important; height: 48px !important; }

@media (min-width: 768px) {
  .fab {
    left: auto; right: 24px; transform: none;
    bottom: max(24px, env(safe-area-inset-bottom));
  }
}

/* Strengthen fixed positioning behavior on iOS/WebViews */
@supports (-webkit-touch-callout: none) {
  .fab {
    position: fixed !important;
  }
}

/* Phone landscape: reduce hero size and avoid overlaps; make gallery 2 cols */
@media (max-width: 896px) and (orientation: landscape) {
  :root { --hero-bleed: 120px; }
  .hero { height: 42vh !important; }
  .hero__content { width: min(92vw, 640px) !important; gap: 12px; margin-top: clamp(16px, 6vh, 56px) !important; }
  .hero__title { font-size: clamp(40px, 9vw, 72px) !important; }
  .hero__actions { gap: 8px; margin-top: 12px; }
  .hero__cta { height: 48px !important; padding: 0 48px !important; }
  .hero__bookmark { width: 48px !important; height: 48px !important; }
  .gallery { width: 96vw; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 22px; margin-top: 20px; }
}

/* Mobile: center FAB and guarantee in-frame width */
@media (max-width: 768px) {
  .fab {
    left: 50%;
    transform: translateX(-50%);
    width: calc(100vw - 24px - env(safe-area-inset-left) - env(safe-area-inset-right));
    max-width: calc(100vw - 24px - env(safe-area-inset-left) - env(safe-area-inset-right));
    padding: 0 8px;
    box-sizing: border-box;
    gap: 8px;
  }
  .fab .hero__cta { flex: 1 1 auto; min-width: 0; max-width: 100%; }
  .fab .hero__bookmark { flex: 0 0 auto; }
}

/* Very short viewports: ensure FAB stays inside vertically */
@media (max-height: 480px) {
  .fab { bottom: max(8px, env(safe-area-inset-bottom)); }
  .fab .hero__cta { height: 44px !important; padding: 0 24px !important; }
  .fab .hero__bookmark { width: 44px !important; height: 44px !important; }
}

/* Tiny landscape heights: further reduce */
@media (orientation: landscape) and (max-height: 420px) {
  .fab { bottom: max(6px, env(safe-area-inset-bottom)); }
  .fab .hero__cta { height: 40px !important; padding: 0 20px !important; }
  .fab .hero__bookmark { width: 40px !important; height: 40px !important; }
}

@keyframes fab-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Launch gate (fullscreen intro) */
.gate {
  position: fixed; inset: 0; z-index: 100000;
  background: #424242;
  display: grid; place-items: center;
  transition: opacity .9s ease;
  /* Block any scroll/overscroll while gate is shown */
  overflow: hidden; overscroll-behavior: none; touch-action: none;
  /* Force hardware acceleration for better performance in in-app browsers */
  transform: translateZ(0); will-change: opacity;
  contain: layout paint;
  padding: 0;
}

/* Vignette respirante (halo radial très léger) */
.gate::before {
  content: '';
  position: absolute; inset: 0; pointer-events: none;
  background: radial-gradient(100% 120% at 50% 50%, transparent 60%, rgba(0,0,0,0.10) 100%);
  opacity: 0; transition: opacity 600ms ease;
}
.gate.is-logo::before { opacity: 1; }
.gate.is-finishing::before { opacity: 0; }

/* In-app browser banner: suggest opening in system browser */
.iab-banner {
  position: fixed;
  top: max(10px, env(safe-area-inset-top));
  left: 50%;
  transform: translateX(-50%);
  z-index: 10050;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
  justify-content: center;
  background: rgba(30, 30, 30, 0.75);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 12px;
  padding: 12px;
  max-width: calc(100vw - 24px - env(safe-area-inset-left) - env(safe-area-inset-right));
}
.iab-text {
  color: #fefff4;
  font-family: 'Playfair Display', serif;
  font-size: clamp(14px, 3.4vw, 16px);
  text-align: center;
  letter-spacing: 0.02em;
  line-height: 1.35;
  margin: 0;
}
.iab-btn {
  all: unset;
  cursor: pointer;
  background: var(--cta-bg);
  color: var(--ink);
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  letter-spacing: 0.06em;
  padding: 10px 16px;
  border-radius: 12px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.18), 0 8px 18px rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.04);
}
.iab-btn--ghost {
  background: transparent;
  color: #fefff4;
  border: 1px solid rgba(255,255,255,0.28);
}
.iab-banner--compact {
  position: sticky;
  top: 0;
  left: 0; right: 0;
  transform: none;
  margin: 6px auto;
  background: rgba(30,30,30,0.7);
  padding: 6px 10px;
  gap: 0;
}
.iab-banner--compact .iab-btn { padding: 6px 10px; font-size: 0.92rem; }
.iab-actions { display: flex; gap: 10px; }
@media (max-width: 420px) {
  .iab-actions { flex-direction: column; width: 100%; }
  .iab-actions .iab-btn { text-align: center; }
}
@media (min-width: 769px) {
  .iab-banner { display: none; }
}

.gate__hit {
  all: unset;
  cursor: pointer;
  position: relative;
  width: 100%;
  height: 100%;
  /* Enhanced touch handling for in-app browsers */
  -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
}
.gate__msg {
  position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
  font-family: 'Playfair Display', serif; text-align: center; max-width: min(92vw, 720px);
  font-size: clamp(18px, 5vw, 32px); line-height: 1.25; letter-spacing: 0.04em;
  color: #fefff4; opacity: 1; transition: opacity .6s ease, transform .6s ease;
  padding: 0 12px;
}
.gate__logo {
  position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%) scale(0.975);
  display: block; margin: 0; height: auto; opacity: 0; /* start hidden for fade-in */
  width: min(52vw, 36vh); /* proportionnel à l'écran */
  max-width: min(380px, calc(100vw - 48px));
  max-height: min(44vh, 44dvh);
  transition: opacity 2000ms cubic-bezier(0.16,1,0.3,1), filter 2000ms cubic-bezier(0.16,1,0.3,1);
  will-change: opacity, transform, filter;
  filter: drop-shadow(0 10px 30px rgba(0,0,0,0.6)) blur(0.6px);

  user-select: none; -webkit-user-select: none; pointer-events: none; -webkit-user-drag: none;
}
/* When inline SVG is used */
.gate__logo svg { display:block; width:100%; height:auto; color: inherit; }
.gate__logo [fill]:not([fill="none"]) { fill: currentColor; }
.gate__logo [stroke]:not([stroke="none"]) { stroke: currentColor; }
.gate.is-starting .gate__msg { opacity: 0; transform: translateY(-12px); }
.gate.is-starting .gate__logo { opacity: 1; }
.gate.is-finishing .gate__msg, .gate.is-finishing .gate__logo { opacity: 0; }
/* lock final zoom at fade-out to avoid snap back */
.gate.is-finishing .gate__logo { transform: translate(-50%, -50%) scale(1.03); transition: opacity 500ms ease; }
.gate.is-finishing { opacity: 0; transition: opacity 500ms ease; }

/* Instant logo state: no fade/crossfade, message hidden */
.gate.is-logo .gate__msg { display: none !important; }
.gate.is-logo .gate__logo { opacity: 1 !important; filter: drop-shadow(0 10px 30px rgba(0,0,0,0.6)) blur(0); animation: gate-zoom 7000ms cubic-bezier(0.16,1,0.3,1) forwards; transform-origin: 50% 50%; }

@keyframes gate-zoom {
  0% { transform: translate(-50%, -50%) scale(0.98); }
  100% { transform: translate(-50%, -50%) scale(1.02); }
}


/* When fading out, let scroll/pan pass through immediately */
.gate.is-finishing {
  pointer-events: none;
}

/* Media queries adjustments for gate logo */
/* logo sizing already proportional; media blocks no longer required */

/* Better mobile scroll prevention with special in-app browser handling */
.no-scroll { 
  overflow: hidden !important; 
  height: 100vh; 
  height: 100dvh; /* Dynamic viewport height for better mobile support */
  /* More gentle approach for in-app browsers */
  position: relative;
  width: 100%;
  /* Prevent scroll chaining but allow some flexibility */
  overscroll-behavior: contain;
}

/* Only apply aggressive scroll prevention on standard browsers */
@media (min-width: 769px) {
  .no-scroll {
    position: fixed;
    -webkit-overflow-scrolling: auto;
    overscroll-behavior: none;
  }
}

/* Mobile-specific improvements with enhanced in-app browser support */
@media (max-width: 768px) {
  .gate {
    position: fixed;
    /* Better touch handling on mobile */
    -webkit-overflow-scrolling: touch;
    /* Less aggressive overscroll for in-app browsers */
    overscroll-behavior: auto;
    /* Enhanced performance for in-app browsers */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
  
  .gate__hit {
    /* Improve touch target */
    min-height: 44px;
    /* Prevent text selection on mobile */
    -webkit-user-select: none;
    user-select: none;
    /* Better touch feedback for in-app browsers */
    -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
    /* Allow scroll gestures to pass through when appropriate */
    touch-action: pan-y;
    /* Enhanced interaction area for in-app browsers */
    padding: 20px;
  }
  
  /* Ensure mobile viewport works well in all contexts */
  .page {
    min-height: 100vh;
    min-height: -webkit-fill-available;
    min-height: 100dvh;
    /* Allow scroll in embedded contexts */
    overscroll-behavior: auto;
  }

  /* Less aggressive fixes for in-app browsers */
  body {
    /* Allow natural scrolling in in-app browsers */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: auto;
  }

  /* Minimal intervention for WebView compatibility */
  html {
    overflow-x: hidden;
    -webkit-text-size-adjust: 100%;
  }
  
  /* Special handling when no-scroll is active on mobile */
  body.no-scroll {
    /* Gentler scroll prevention for mobile/in-app */
    overflow: hidden;
    position: relative;
    height: 100vh;
    /* Don't use fixed positioning on mobile */
  }
}

/* Enhanced adjustments for WebView contexts */
@supports (-webkit-touch-callout: none) {
  .gate {
    /* iOS WebView specific fixes */
    -webkit-overflow-scrolling: touch;
    /* Better performance in WebViews */
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }
  
  .gate__hit {
    /* Enhanced touch response in WebViews */
    -webkit-tap-highlight-color: rgba(255, 255, 255, 0.05);
    /* Better interaction handling but allow scroll */
    -webkit-touch-callout: none;
    touch-action: manipulation;
  }
  
  .no-scroll {
    /* Less aggressive scroll prevention on iOS WebView */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: auto;
    /* Don't use fixed positioning in WebViews */
    position: relative !important;
  }
}

/* Special handling for known in-app browsers */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  /* Detect WebKit browsers (includes most in-app browsers) */
  .no-scroll {
    /* Minimal scroll intervention */
    overflow-y: auto;
    position: relative;
    /* Allow momentum scrolling */
    -webkit-overflow-scrolling: touch;
  }
  
  .gate {
    /* Ensure gate works without breaking scroll */
    overscroll-behavior: auto;
  }
}

/* Force-mobile layout override after exiting fullscreen */
body.force-mobile .gallery { grid-template-columns: 1fr !important; width: 94vw !important; gap: 32px !important; }
body.force-mobile .hero { padding: 24px 16px !important; height: 62vh !important; justify-content: center !important; }

/* Reader splash (transition from hub to reader) */
.reader-splash {
  position: fixed; inset: 0; z-index: 2000;
  display: grid; place-items: center;
  padding: max(16px, env(safe-area-inset-top)) max(16px, env(safe-area-inset-right)) max(24px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left));
  color: #1f2023;
  animation: splash-enter 880ms ease-out both;
}
.reader-splash__card { width: min(560px, 68vw); margin-left: auto; margin-right: auto; }
.reader-splash__img { width: 100%; aspect-ratio: 16/9; border-radius: 16px; display: block; box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
.reader-splash__line { margin-top: clamp(18px, 3.6vw, 28px); display: flex; align-items: baseline; gap: 12px; }
.reader-splash__badge { display: inline-grid; place-items: center; width: 22px; height: 22px; border-radius: 50%; background: #1f2023; color: #FEFFF4; font-weight: 700; font-size: 0.9rem; }
.reader-splash__label { display: none; }
.reader-splash__title { font-family: 'Playfair Display', serif; font-weight: 700; letter-spacing: 0.02em; opacity: 0; transform: translateY(6px); }

.simple .reader-splash__img { opacity: 0; animation: fade-in 700ms ease-out 100ms forwards; }
.simple .reader-splash__badge, .simple .reader-splash__title { opacity: 0; transform: translateY(6px); animation: fade-in-up 700ms ease-out 250ms forwards; }
.phase-exit { animation: splash-exit 500ms cubic-bezier(.4,0,.6,1) both; }

@keyframes splash-enter { from { opacity: 0; transform: scale(0.96); } to { opacity: 1; transform: scale(1); } }
@keyframes chapter-wipe { from { transform: translateX(0%); } to { transform: translateX(-102%); } }
@keyframes title-in { from { opacity: 0; transform: translateY(6px);} to { opacity: 1; transform: translateY(0);} }
@keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
@keyframes fade-in-up { from { opacity: 0; transform: translateY(6px);} to { opacity: 1; transform: translateY(0);} }
@keyframes splash-exit { from { opacity: 1; transform: translateY(0);} to { opacity: 0; transform: translateY(-12px);} }

@media (prefers-reduced-motion: reduce) {
  .reader-splash { animation-duration: 480ms; }
  .phase-wipe .reader-splash__label::after { animation-duration: 480ms; }
  .phase-title .reader-splash__title, .phase-wait .reader-splash__title { animation-duration: 480ms; }
  .phase-exit { animation-duration: 640ms; }
}

/* Reader base */
.reader { position: fixed; inset: 0; background: #FEFFF4; color: #1f2023; display: flex; flex-direction: column; }
.reader__header { height: 48px; display: flex; align-items: center; gap: 12px; padding: 8px 12px; }
.reader__header { justify-content: space-between; }
.reader__header-left, .reader__header-right { display: flex; gap: 10px; align-items: center; }
.reader__header-center { display: flex; flex-direction: column; align-items: center; gap: 2px; }
.reader__book { font-family: 'Playfair Display', serif; font-weight: 700; letter-spacing: 0.02em; }
.reader__page { font-size: 12px; opacity: 0.75; }
.reader__icon { all: unset; cursor: pointer; font-size: 18px; }
.reader__icon.is-on { filter: drop-shadow(0 0 0 #ffff80); }
.reader__sep { opacity: 0.5; }
.reader__pill { all: unset; cursor: pointer; font-weight: 700; padding: 2px 8px; border-radius: 8px; background: rgba(0,0,0,0.06); }
.reader__pill--accent, .reader__pill.is-active { background: #ffff80; color: #111; }
.reader__stage { position: relative; flex: 1 1 auto; overflow: hidden; }

.reader-page { position: absolute; inset: 0; padding: 24px 20px 32px; touch-action: none; display: flex; flex-direction: column; gap: 16px; }
.para { font-family: 'Libre Baskerville','Playfair Display',serif; font-size: calc(18px * var(--reader-font-scale, 1)); line-height: 1.6; }
.dlg { display: flex; align-items: baseline; gap: 8px; }
.dlg__icon { width: 20px; }
.dlg__bar { width: 2px; height: 1.2em; background: #1f2023; opacity: 0.6; }
.dlg__speaker { font-weight: 700; }
.dlg--read { opacity: 0.66; filter: grayscale(0.1); }

.music-rail { position: relative; width: 28px; display: flex; flex-direction: column; align-items: center; gap: 6px; touch-action: pan-y; }
.music-rail__icon { 
  font-size: 18px; 
  user-select: none;
}
.music-rail__track { position: relative; flex: 1; width: 10px; background: linear-gradient(#4b4b4b,#3e3e3e); border-radius: 8px; overflow: hidden; cursor: ns-resize; box-shadow: inset 0 1px 2px rgba(0,0,0,0.4); }
.music-rail__fill { 
  position: absolute; 
  left: 0; 
  bottom: 0; 
  right: 0; 
  background: #ffff80;
  transition: height 0.1s ease;
}

/* ...existing code... */

/* Voice (dialogue) volume rail */
.voice-rail { position: relative; width: 28px; display: flex; flex-direction: column; align-items: center; gap: 6px; touch-action: pan-y; }
.voice-rail__icon { font-size: 18px; user-select: none; }
.voice-rail__track { position: relative; flex: 1; width: 10px; background: linear-gradient(#4b4b4b,#3e3e3e); border-radius: 8px; overflow: hidden; cursor: ns-resize; box-shadow: inset 0 1px 2px rgba(0,0,0,0.4); }
.voice-rail__fill { position: absolute; left: 0; bottom: 0; right: 0; background: #b3e5fc; transition: height 0.1s ease; }

/* Fullscreen button (robust reset to avoid oversized rendering) */
.fs-btn { all: unset; position: fixed; top: max(12px, env(safe-area-inset-top)); right: max(12px, env(safe-area-inset-right)); z-index: 10060; display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 10px; background: rgba(30,30,30,0.75); border: 1px solid rgba(255,255,255,0.16); color: #fefff4; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.25); font-size: 0; }
.fs-btn svg { width: 20px; height: 20px; display: block; fill: currentColor; }
/* Always show the fullscreen toggle on the hub (positioned top-right) */
/* No hide on mobile to keep an accessible exit */

/* Theme floating toggle */
.reader__theme { width: 40px; height: 40px; border-radius: 20px; border: 1px solid rgba(0,0,0,0.2); background: rgba(0,0,0,0.08); cursor: pointer; }

/* Overlay */
.reader__overlay { position: absolute; inset: 0; display: flex; flex-direction: column; justify-content: flex-end; padding: 10px 10px max(12px, env(safe-area-inset-bottom)) 10px; background: linear-gradient(to top, rgba(0,0,0,0.25), rgba(0,0,0,0)); }
.reader__overlay-topbar { position: absolute; top: 8px; left: 8px; right: 8px; display: flex; align-items: center; justify-content: space-between; gap: 8px; pointer-events: auto; }
.reader__overlay-tools { display: flex; gap: 8px; align-items: center; }
.reader__overlay-rails { position: absolute; top: 56px; right: 8px; bottom: 88px; display: flex; flex-direction: column; gap: 14px; align-items: center; pointer-events: auto; }
.reader__carousel { display: flex; gap: 12px; overflow: auto; padding: 8px 2px; }
.reader__thumb { min-width: 160px; border-radius: 10px; background: #2a2a2a; color: #eee; overflow: hidden; position: relative; }
.reader__thumb-img { height: 80px; background: url('https://picsum.photos/320/180?blur=1') center/cover no-repeat; }
.reader__thumb-meta { display: flex; align-items: center; justify-content: space-between; padding: 6px 8px; font-size: 12px; }
.reader__thumb-badge { display: inline-grid; place-items: center; width: 20px; height: 20px; border-radius: 10px; background: #ffff80; color: #111; font-weight: 700; }
.reader__dock { margin-top: 8px; display: flex; align-items: center; justify-content: space-between; gap: 8px; flex-wrap: nowrap; pointer-events: auto; }
.reader__dock-btn.is-active { outline: 2px solid #111; box-shadow: 0 0 0 2px #ffff80 inset; }
.reader__panel { margin-top: 8px; background: rgba(0,0,0,0.35); border: 1px solid rgba(255,255,255,0.2); border-radius: 12px; padding: 10px; color: #fff; }
.reader__panel-title { font-weight: 700; margin-bottom: 8px; }
.reader__panel-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(44px, 1fr)); gap: 6px; }
.reader__cell { all: unset; display: grid; place-items: center; height: 44px; background: rgba(0,0,0,0.2); border-radius: 8px; color: #fff; cursor: pointer; }
.reader__cell.is-current { background: #ffff80; color: #111; font-weight: 800; }

/* Responsive overlay tweaks */
@media (max-width: 768px) {
  .reader__overlay-topbar { top: 6px; left: 6px; right: 6px; }
  .reader__overlay-rails { position: absolute; top: 56px; right: 8px; bottom: 88px; display: flex; flex-direction: column; gap: 14px; align-items: center; pointer-events: auto; }
  .reader__dock { gap: 6px; }
}
.reader__overlay-rails { padding-right: max(8px, env(safe-area-inset-right)); }
@media (max-height: 420px) and (orientation: landscape) {
  .reader__overlay-rails { position: static; flex-direction: row; justify-content: center; align-items: flex-end; gap: 12px; }
  .reader__overlay { padding-bottom: max(8px, env(safe-area-inset-bottom)); }
}
.reader__dock-ind { display: inline-grid; place-items: center; width: 28px; height: 28px; border-radius: 14px; background: #2a2a2a; color: #ffff80; font-weight: 800; }
.reader__dock-btn { all: unset; background: #4b4b4b; color: #f2f2f2; padding: 8px 14px; border-radius: 16px; font-weight: 800; letter-spacing: 0.04em; cursor: pointer; border: 1px solid rgba(255,255,255,0.25); box-shadow: 0 1px 2px rgba(0,0,0,0.25) inset; }
.reader__dock-btn.is-active { background: #ffff80; color: #111; border-color: #111; box-shadow: 0 0 0 2px #ffff80; }
.reader__dock-home { all: unset; width: 36px; height: 36px; display: grid; place-items: center; background: #2a2a2a; color: #fff; border-radius: 18px; cursor: pointer; border: 2px dotted #ffff80; }

/* Dark theme */
.reader[data-theme='dark'] { background: #2b2b2b; color: #f0f0f0; }
.reader[data-theme='dark'] .para { color: #f0f0f0; }
.reader[data-theme='dark'] .dlg__bar { background: #f0f0f0; opacity: 0.5; }


.reader__audio-prompt{position:absolute;left:50%;top:12px;transform:translateX(-50%);background:rgba(0,0,0,.72);color:#fff;padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.25);z-index:10060;font-weight:700;letter-spacing:.02em;cursor:pointer}
.reader__audio-prompt:focus-visible{outline:3px solid #ffff80;outline-offset:2px}

/* Skeleton states for loading tales */
.card--skeleton .card__media { background: #3b3b3b !important; filter: saturate(0.6) brightness(0.9); }
.card--skeleton .card__overlay { opacity: 0.4; }
.card--skeleton .card__label { color: transparent !important; background: linear-gradient(90deg, rgba(255,255,255,0.08), rgba(255,255,255,0.18), rgba(255,255,255,0.08)); background-size: 200% 100%; animation: shimmer 1.2s ease-in-out infinite; border-radius: 6px; min-height: 1.8rem; }
.card--skeleton .card__badge { background: #666 !important; color: transparent !important; box-shadow: none !important; border: none !important; }
@keyframes shimmer { 0% { background-position: 0% 0; } 100% { background-position: 200% 0; } }

/* Extra-wide screens: 4 columns gallery */
@media (min-width: 1536px) {
  .gallery { grid-template-columns: repeat(4, minmax(0, 1fr)); width: min(1480px, 90vw); }
}




